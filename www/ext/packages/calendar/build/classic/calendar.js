var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty=typeof Object.defineProperties=='function'?Object.defineProperty:function(b,c,a){a=(a);if(b==Array.prototype||b==Object.prototype){return}b[c]=a.value};$jscomp.getGlobal=function(a){return typeof window!='undefined'&&window===a?a:typeof global!='undefined'&&global!=null?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(i,f,j,k){if(!f){return}var a=$jscomp.global;var b=i.split('.');for(var e=0;e<b.length-1;e++){var d=b[e];if(!(d in a)){a[d]={}}a=a[d]}var g=b[b.length-1];var h=a[g];var c=f(h);if(c==h||c==null){return}$jscomp.defineProperty(a,g,{configurable:!0,writable:!0,value:c})};$jscomp.polyfill('Array.prototype.copyWithin',function(a){if(a){return a}var b=function(d,c,b){var e=this.length;d=Number(d);c=Number(c);b=Number(b!=null?b:e);if(d<c){b=Math.min(b,e);while(c<b){if(c in this){this[d++]=this[c++]}else {delete this[d++];c++}}}else {b=Math.min(b,e+c-d);d+=b-c;while(b>c){if(--b in this){this[--d]=this[b]}else {delete this[d]}}}return this};return b},'es6-impl','es3');$jscomp.SYMBOL_PREFIX='jscomp_symbol_';$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};if(!$jscomp.global['Symbol']){$jscomp.global['Symbol']=$jscomp.Symbol}};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return ($jscomp.SYMBOL_PREFIX+(a||'')+$jscomp.symbolCounter_++)};$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global['Symbol'].iterator;if(!a){a=$jscomp.global['Symbol'].iterator=$jscomp.global['Symbol']('iterator')}if(typeof Array.prototype[a]!='function'){$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}})}$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){if(b<a.length){return {done:!1,value:a[b++]}}else {return {done:!0}}})};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();var a={next:b};a[$jscomp.global['Symbol'].iterator]=function(){return this};return (a)};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();if(a instanceof String){a=a+''}var c=0;var b={next:function(){if(c<a.length){var e=c++;return {value:d(e,a[e]),done:!1}}b.next=function(){return {done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.entries',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b,c){return [b,c]})};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.fill',function(a){if(a){return a}var b=function(f,c,b){var d=this.length||0;if(c<0){c=Math.max(0,d+(c))}if(b==null||b>d){b=d}b=Number(b);if(b<0){b=Math.max(0,d+b)}for(var e=Number(c||0);e<b;e++){this[e]=f}return this};return b},'es6-impl','es3');$jscomp.findInternal=function(a,d,e){if(a instanceof String){a=(String(a))}var f=a.length;for(var b=0;b<f;b++){var c=a[b];if(d.call(e,c,b,a)){return {i:b,v:c}}}return {i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).v};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.findIndex',function(a){if(a){return a}var b=function(c,b){return $jscomp.findInternal(this,c,b).i};return b},'es6-impl','es3');$jscomp.polyfill('Array.from',function(a){if(a){return a}var b=function(b,c,g){$jscomp.initSymbolIterator();c=c!=null?c:function(d){return d};var d=[];var f=(b)[Symbol.iterator];if(typeof f=='function'){b=f.call(b);var h;while(!(h=b.next()).done){d.push(c.call((g),h.value))}}else {var i=b.length;for(var e=0;e<i;e++){d.push(c.call((g),b[e]))}}return d};return b},'es6-impl','es3');$jscomp.polyfill('Object.is',function(a){if(a){return a}var b=function(b,c){if(b===c){return b!==0||1/b===1/(c)}else {return b!==b&&c!==c}};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.includes',function(a){if(a){return a}var b=function(d,e){var b=this;if(b instanceof String){b=(String(b))}var f=b.length;for(var c=e||0;c<f;c++){if(b[c]==d||Object.is(b[c],d)){return !0}}return !1};return b},'es7','es3');$jscomp.polyfill('Array.prototype.keys',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(b){return b})};return b},'es6-impl','es3');$jscomp.polyfill('Array.of',function(a){if(a){return a}var b=function(b){return Array.from(arguments)};return b},'es6-impl','es3');$jscomp.polyfill('Array.prototype.values',function(a){if(a){return a}var b=function(){return $jscomp.iteratorFromArray(this,function(c,b){return b})};return b},'es6','es3');$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=(a)[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator((a))};$jscomp.EXPOSE_ASYNC_EXECUTOR=!0;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill('Promise',function(c){if(c&&!$jscomp.FORCE_POLYFILL_PROMISE){return c}function AsyncExecutor(){this.batch_=null}AsyncExecutor.prototype.asyncExecute=function(a){if(this.batch_==null){this.batch_=[];this.asyncExecuteBatch_()}this.batch_.push(a);return this};AsyncExecutor.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var e=$jscomp.global['setTimeout'];AsyncExecutor.prototype.asyncExecuteFunction=function(a){e(a,0)};AsyncExecutor.prototype.executeBatch_=function(){while(this.batch_&&this.batch_.length){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var d=b[a];delete b[a];try{d()}catch(f){this.asyncThrow_(f)}}}this.batch_=null};AsyncExecutor.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a})};var b={PENDING:0,FULFILLED:1,REJECTED:2};var a=function(d){this.state_=b.PENDING;this.result_=undefined;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{d(a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.createResolveAndReject_=function(){var b=this;var a=!1;function firstCallWins(d){return function(e){if(!a){a=!0;d.call(b,e)}}}return {resolve:firstCallWins(this.resolveTo_),reject:firstCallWins(this.reject_)}};a.prototype.resolveTo_=function(b){if(b===this){this.reject_(new TypeError('A Promise cannot resolve to itself'))}else {if(b instanceof a){this.settleSameAsPromise_((b))}else {if(isObject(b)){this.resolveToNonPromiseObj_((b))}else {this.fulfill_(b)}}}};a.prototype.resolveToNonPromiseObj_=function(b){var a=undefined;try{a=b.then}catch(f){this.reject_(f);return}if(typeof a=='function'){this.settleSameAsThenable_(a,(b))}else {this.fulfill_(b)}};function isObject(a){switch(typeof a){case 'object':return a!=null;case 'function':return !0;default:return !1;}}a.prototype.reject_=function(a){this.settle_(b.REJECTED,a)};a.prototype.fulfill_=function(a){this.settle_(b.FULFILLED,a)};a.prototype.settle_=function(d,a){if(this.state_!=b.PENDING){throw new Error('Cannot settle('+d+', '+a|'): Promise already settled in state'+this.state_)}this.state_=d;this.result_=a;this.executeOnSettledCallbacks_()};a.prototype.executeOnSettledCallbacks_=function(){if(this.onSettledCallbacks_!=null){var b=this.onSettledCallbacks_;for(var a=0;a<b.length;++a){(b[a]).call();b[a]=null}this.onSettledCallbacks_=null}};var d=new AsyncExecutor();a.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};a.prototype.settleSameAsThenable_=function(b,d){var a=this.createResolveAndReject_();try{b.call(d,a.resolve,a.reject)}catch(f){a.reject(f)}};a.prototype.then=function(f,g){var b;var d;var e=new a(function(a,e){b=a;d=e});function createCallback(a,e){if(typeof a=='function'){return function(h){try{b(a(h))}catch(i){d(i)}}}else {return e}}this.callWhenSettled_(createCallback(f,b),createCallback(g,d));return e};a.prototype['catch']=function(a){return this.then(undefined,a)};a.prototype.callWhenSettled_=function(e,f){var a=this;function callback(){switch(a.state_){case b.FULFILLED:e(a.result_);break;case b.REJECTED:f(a.result_);break;default:throw new Error('Unexpected state: '+a.state_);}}if(this.onSettledCallbacks_==null){d.asyncExecute(callback)}else {this.onSettledCallbacks_.push(function(){d.asyncExecute(callback)})}};a.resolve=function(b){if(b instanceof a){return b}else {return new a(function(a,d){a(b)})}};a.reject=function(b){return new a(function(d,a){a(b)})};a.race=function(b){return new a(function(f,g){var e=$jscomp.makeIterator(b);for(var d=e.next();!d.done;d=e.next()){a.resolve(d.value).callWhenSettled_(f,g)}})};a.all=function(e){var d=$jscomp.makeIterator(e);var b=d.next();if(b.done){return a.resolve([])}else {return new a(function(h,i){var f=[];var g=0;function onFulfilled(a){return function(b){f[a]=b;g--;if(g==0){h(f)}}}do{f.push(undefined);g++;a.resolve(b.value).callWhenSettled_(onFulfilled(f.length-1),i);b=d.next()}while(!b.done)})}};if($jscomp.EXPOSE_ASYNC_EXECUTOR){a['$jscomp$new$AsyncExecutor']=function(){return new AsyncExecutor()}}return a},'es6-impl','es3');$jscomp.executeAsyncGenerator=function(a){function passValueToGenerator(b){return a.next(b)}function passErrorToGenerator(b){return a['throw'](b)}return new Promise(function(b,c){function handleGeneratorRecord(d){if(d.done){b(d.value)}else {Promise.resolve(d.value).then(passValueToGenerator,passErrorToGenerator).then(handleGeneratorRecord,c)}}handleGeneratorRecord(a.next())})};$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.polyfill('WeakMap',function(c){function isConformant(){if(!c||!Object.seal){return !1}try{var b=Object.seal({});var d=Object.seal({});var a=new (c)([[b,2],[d,3]]);if(a.get(b)!=2||a.get(d)!=3){return !1}a['delete'](b);a.set(d,4);return !a.has(b)&&a.get(d)==4}catch(e){return !1}}if(isConformant()){return c}var a='$jscomp_hidden_'+Math.random().toString().substring(2);function insert(b){if(!$jscomp.owns(b,a)){var d={};$jscomp.defineProperty(b,a,{value:d})}}function patch(a){var b=Object[a];if(b){Object[a]=function(d){insert(d);return b(d)}}}patch('freeze');patch('preventExtensions');patch('seal');var d=0;var b=function(a){this.id_=(d+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=$jscomp.makeIterator(a);var b;while(!(b=f.next()).done){var e=b.value;this.set((e[0]),(e[1]))}}};b.prototype.set=function(b,d){insert(b);if(!$jscomp.owns(b,a)){throw new Error('WeakMap key fail: '+b)}b[a][this.id_]=d;return this};b.prototype.get=function(b){return $jscomp.owns(b,a)?b[a][this.id_]:undefined};b.prototype.has=function(b){return $jscomp.owns(b,a)&&$jscomp.owns(b[a],this.id_)};b.prototype['delete']=function(b){if(!$jscomp.owns(b,a)||!$jscomp.owns(b[a],this.id_)){return !1}return delete b[a][this.id_]};return b},'es6-impl','es3');$jscomp.MapEntry=function(){this.previous;this.next;this.head;this.key;this.value};$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.polyfill('Map',function(b){var g=!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var e=Object.seal({x:4});var c=new b($jscomp.makeIterator([[e,'s']]));if(c.get(e)!='s'||c.size!=1||c.get({x:4})||c.set({x:4},'t')!=c||c.size!=2){return !1}var d=c.entries();var a=d.next();if(a.done||a.value[0]!=e||a.value[1]!='s'){return !1}a=d.next();if(a.done||a.value[0].x!=4||a.value[1]!='t'||!d.next().done){return !1}return !0}catch(j){return !1}}();if(g){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap();var a=function(a){this.data_={};this.head_=f();this.size=0;if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=(c).value;this.set((d[0]),(d[1]))}}};a.prototype.set=function(e,d){var a=c(this,e);if(!a.list){a.list=this.data_[a.id]=[]}if(!a.entry){a.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:d};a.list.push(a.entry);this.head_.previous.next=a.entry;this.head_.previous=a.entry;this.size++}else {a.entry.value=d}return this};a.prototype['delete']=function(d){var a=c(this,d);if(a.entry&&a.list){a.list.splice(a.index,1);if(!a.list.length){delete this.data_[a.id]}a.entry.previous.next=a.entry.next;a.entry.next.previous=a.entry.previous;a.entry.head=null;this.size--;return !0}return !1};a.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=f();this.size=0};a.prototype.has=function(a){return !!c(this,a).entry};a.prototype.get=function(d){var a=c(this,d).entry;return (a&&(a.value))};a.prototype.entries=function(){return d(this,function(a){return [a.key,a.value]})};a.prototype.keys=function(){return d(this,function(a){return a.key})};a.prototype.values=function(){return d(this,function(a){return a.value})};a.prototype.forEach=function(e,d){var f=this.entries();var c;while(!(c=f.next()).done){var a=c.value;e.call((d),(a[1]),(a[0]),this)}};(a.prototype)[Symbol.iterator]=a.prototype.entries;var c=function(g,e){var f=i(e);var a=g.data_[f];if(a&&$jscomp.owns(g.data_,f)){for(var d=0;d<a.length;d++){var c=a[d];if(e!==e&&c.key!==c.key||e===c.key){return {id:f,list:a,index:d,entry:c}}}}return {id:f,list:a,index:-1,entry:undefined}};var d=function(c,d){var a=c.head_;return $jscomp.iteratorPrototype(function(){if(a){while(a.head!=c.head_){a=a.previous}while(a.next!=a.head){a=a.next;return {done:!1,value:d(a)}}a=null}return {done:!0,value:void 0}})};var f=function(){var a={};a.previous=a.next=a.head=a;return a};var h=0;var i=function(a){var c=a&&typeof a;if(c=='object'||c=='function'){a=(a);if(!e.has(a)){var d=''+ ++h;e.set(a,d);return d}return e.get(a)}return 'p_'+a};return a},'es6-impl','es3');$jscomp.polyfill('Math.acosh',function(a){if(a){return a}var b=function(b){b=Number(b);return Math.log(b+Math.sqrt(b*b-1))};return b},'es6-impl','es3');$jscomp.polyfill('Math.asinh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.log(Math.abs(b)+Math.sqrt(b*b+1));return b<0?-c:c};return b},'es6-impl','es3');$jscomp.polyfill('Math.log1p',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var f=b;var g=1;var c=b;var d=0;var e=1;while(d!=c){f*=b;e*=-1;c=(d=c)+e*f/++g}return c}return Math.log(1+b)};return b},'es6-impl','es3');$jscomp.polyfill('Math.atanh',function(b){if(b){return b}var a=Math.log1p;var c=function(c){c=Number(c);return (a(c)-a(-c))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.cbrt',function(a){if(a){return a}var b=function(b){if(b===0){return b}b=Number(b);var c=Math.pow(Math.abs(b),1/3);return b<0?-c:c};return b},'es6-impl','es3');$jscomp.polyfill('Math.clz32',function(a){if(a){return a}var b=function(b){b=Number(b)>>>0;if(b===0){return 32}var c=0;if((b&4.29490176E9)===0){b<<=16;c+=16}if((b&4.27819008E9)===0){b<<=8;c+=8}if((b&4.02653184E9)===0){b<<=4;c+=4}if((b&3.221225472E9)===0){b<<=2;c+=2}if((b&2.147483648E9)===0){c++}return c};return b},'es6-impl','es3');$jscomp.polyfill('Math.cosh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);return (b(c)+b(-c))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.expm1',function(a){if(a){return a}var b=function(b){b=Number(b);if(b<0.25&&b>-0.25){var e=b;var f=1;var c=b;var d=0;while(d!=c){e*=b/++f;c=(d=c)+e}return c}return Math.exp(b)-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.hypot',function(a){if(a){return a}var b=function(c,d,h){c=Number(c);d=Number(d);var b,g,f;var e=Math.max(Math.abs(c),Math.abs(d));for(b=2;b<arguments.length;b++){e=Math.max(e,Math.abs(arguments[b]))}if(e>1.0E100||e<1.0E-100){c=c/e;d=d/e;f=c*c+d*d;for(b=2;b<arguments.length;b++){g=Number(arguments[b])/e;f+=g*g}return Math.sqrt(f)*e}else {f=c*c+d*d;for(b=2;b<arguments.length;b++){g=Number(arguments[b]);f+=g*g}return Math.sqrt(f)}};return b},'es6-impl','es3');$jscomp.polyfill('Math.imul',function(a){if(a){return a}var b=function(b,c){b=Number(b);c=Number(c);var f=b>>>16&65535;var d=b&65535;var g=c>>>16&65535;var e=c&65535;var h=f*e+d*g<<16>>>0;return d*e+h|0};return b},'es6-impl','es3');$jscomp.polyfill('Math.log10',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN10};return b},'es6-impl','es3');$jscomp.polyfill('Math.log2',function(a){if(a){return a}var b=function(b){return Math.log(b)/Math.LN2};return b},'es6-impl','es3');$jscomp.polyfill('Math.sign',function(a){if(a){return a}var b=function(b){b=Number(b);return b===0||isNaN(b)?b:b>0?1:-1};return b},'es6-impl','es3');$jscomp.polyfill('Math.sinh',function(a){if(a){return a}var b=Math.exp;var c=function(c){c=Number(c);if(c===0){return c}return (b(c)-b(-c))/2};return c},'es6-impl','es3');$jscomp.polyfill('Math.tanh',function(a){if(a){return a}var b=function(b){b=Number(b);if(b===0){return b}var c=Math.exp(-2*Math.abs(b));var d=(1-c)/(1+c);return b<0?-d:d};return b},'es6-impl','es3');$jscomp.polyfill('Math.trunc',function(a){if(a){return a}var b=function(b){b=Number(b);if(isNaN(b)||b===Infinity||b===-Infinity||b===0){return b}var c=Math.floor(Math.abs(b));return b<0?-c:c};return b},'es6-impl','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6-impl','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.MIN_SAFE_INTEGER',function(){return -9.007199254740991E15},'es6-impl','es3');$jscomp.polyfill('Number.isFinite',function(a){if(a){return a}var b=function(b){if(typeof b!=='number'){return !1}return !isNaN(b)&&b!==Infinity&&b!==-Infinity};return b},'es6-impl','es3');$jscomp.polyfill('Number.isInteger',function(a){if(a){return a}var b=function(b){if(!Number.isFinite(b)){return !1}return b===Math.floor(b)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isNaN',function(a){if(a){return a}var b=function(b){return typeof b==='number'&&isNaN(b)};return b},'es6-impl','es3');$jscomp.polyfill('Number.isSafeInteger',function(a){if(a){return a}var b=function(b){return Number.isInteger(b)&&Math.abs(b)<=Number.MAX_SAFE_INTEGER};return b},'es6-impl','es3');$jscomp.polyfill('Object.assign',function(a){if(a){return a}var b=function(e,f){for(var d=1;d<arguments.length;d++){var b=arguments[d];if(!b){continue}for(var c in b){if($jscomp.owns(b,c)){e[c]=b[c]}}}return e};return b},'es6-impl','es3');$jscomp.polyfill('Object.entries',function(a){if(a){return a}var b=function(c){var d=[];for(var b in c){if($jscomp.owns(c,b)){d.push([b,c[b]])}}return d};return b},'es8','es3');$jscomp.polyfill('Object.getOwnPropertySymbols',function(a){if(a){return a}return function(){return []}},'es6-impl','es5');$jscomp.polyfill('Reflect.ownKeys',function(b){if(b){return b}var a='jscomp_symbol_';function isSymbol(c){return c.substring(0,a.length)==a}var c=function(e){var f=[];var c=Object.getOwnPropertyNames(e);var d=Object.getOwnPropertySymbols(e);for(var a=0;a<c.length;a++){(isSymbol(c[a])?d:f).push(c[a])}return f.concat(d)};return c},'es6','es5');$jscomp.polyfill('Object.getOwnPropertyDescriptors',function(a){if(a){return a}var b=function(e){var d={};var c=Reflect.ownKeys(e);for(var b=0;b<c.length;b++){d[c[b]]=Object.getOwnPropertyDescriptor(e,c[b])}return d};return b},'es8','es5');$jscomp.polyfill('Object.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(b,c){b.__proto__=c;if(b.__proto__!==c){throw new TypeError(b+' is not extensible')}return b};return b},'es6','es5');$jscomp.polyfill('Object.values',function(a){if(a){return a}var b=function(b){var c=[];for(var d in b){if($jscomp.owns(b,d)){c.push(b[d])}}return c};return b},'es8','es3');$jscomp.polyfill('Reflect.apply',function(a){if(a){return a}var c=Function.prototype.apply;var b=function(e,d,b){return c.call(e,d,b)};return b},'es6','es3');$jscomp.polyfill('Reflect.construct',function(a){if(a){return a}var b=function(c,e,b){if(b===undefined){b=c}var f=b.prototype||Object.prototype;var d=Object.create(f);var g=Reflect.apply(c,d,e);return g||d};return b},'es6','es5');$jscomp.polyfill('Reflect.defineProperty',function(a){if(a){return a}var b=function(e,d,c){try{Object.defineProperty(e,d,c);var b=Object.getOwnPropertyDescriptor(e,d);if(!b){return !1}return b.configurable===(c.configurable||!1)&&b.enumerable===(c.enumerable||!1)&&('value' in b?b.value===c.value&&b.writable===(c.writable||!1):b.get===c.get&&b.set===c.set)}catch(f){return !1}};return b},'es6','es5');$jscomp.polyfill('Reflect.deleteProperty',function(a){if(a){return a}var b=function(c,b){if(!$jscomp.owns(c,b)){return !0}try{return delete c[b]}catch(d){return !1}};return b},'es6','es3');$jscomp.polyfill('Reflect.getOwnPropertyDescriptor',function(a){return a||Object.getOwnPropertyDescriptor},'es6','es5');$jscomp.polyfill('Reflect.getPrototypeOf',function(a){return a||Object.getPrototypeOf},'es6','es5');$jscomp.findDescriptor=function(d,c){var a=d;while(a){var b=Reflect.getOwnPropertyDescriptor(a,c);if(b){return b}a=Reflect.getPrototypeOf(a)}return undefined};$jscomp.polyfill('Reflect.get',function(a){if(a){return a}var b=function(d,c,e){if(arguments.length<=2){return d[c]}var b=$jscomp.findDescriptor(d,c);if(b){return b.get?b.get.call(e):b.value}return undefined};return b},'es6','es5');$jscomp.polyfill('Reflect.has',function(a){if(a){return a}var b=function(c,b){return b in c};return b},'es6','es3');$jscomp.polyfill('Reflect.isExtensible',function(a){if(a){return a}if(typeof Object.isExtensible=='function'){return Object.isExtensible}return function(){return !0}},'es6','es3');$jscomp.polyfill('Reflect.preventExtensions',function(a){if(a){return a}if(typeof Object.preventExtensions!='function'){return function(){return !1}}var b=function(b){Object.preventExtensions(b);return !Object.isExtensible(b)};return b},'es6','es3');$jscomp.polyfill('Reflect.set',function(a){if(a){return a}var b=function(b,d,e,f){var c=$jscomp.findDescriptor(b,d);if(!c){if(Reflect.isExtensible(b)){b[d]=e;return !0}return !1}if(c.set){c.set.call(arguments.length>3?f:b,e);return !0}else {if(c.writable&&!Object.isFrozen(b)){b[d]=e;return !0}}return !1};return b},'es6','es5');$jscomp.polyfill('Reflect.setPrototypeOf',function(a){if(a){return a}if(typeof ''.__proto__!='object'){return null}var b=function(b,c){try{b.__proto__=c;return b.__proto__===c}catch(d){return !1}};return b},'es6','es5');$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.polyfill('Set',function(b){var c=!$jscomp.ASSUME_NO_NATIVE_SET&&function(){if(!b||!b.prototype.entries||typeof Object.seal!='function'){return !1}try{b=(b);var d=Object.seal({x:4});var c=new b($jscomp.makeIterator([d]));if(!c.has(d)||c.size!=1||c.add(d)!=c||c.size!=1||c.add({x:4})!=c||c.size!=2){return !1}var e=c.entries();var a=e.next();if(a.done||a.value[0]!=d||a.value[1]!=d){return !1}a=e.next();if(a.done||a.value[0]==d||a.value[0].x!=4||a.value[1]!=a.value[0]){return !1}return e.next().done}catch(f){return !1}}();if(c){return b}$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=function(a){this.map_=new Map();if(a){var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=(c).value;this.add(d)}}this.size=this.map_.size};a.prototype.add=function(a){this.map_.set(a,a);this.size=this.map_.size;return this};a.prototype['delete']=function(c){var a=this.map_['delete'](c);this.size=this.map_.size;return a};a.prototype.clear=function(){this.map_.clear();this.size=0};a.prototype.has=function(a){return this.map_.has(a)};a.prototype.entries=function(){return this.map_.entries()};a.prototype.values=function(){return this.map_.values()};a.prototype.keys=a.prototype.values;(a.prototype)[Symbol.iterator]=a.prototype.values;a.prototype.forEach=function(c,a){var d=this;this.map_.forEach(function(e){return c.call((a),e,e,d)})};return a},'es6-impl','es3');$jscomp.checkStringArgs=function(a,c,b){if(a==null){throw new TypeError("The 'this' value for String.prototype."+b+' must not be null or undefined')}if(c instanceof RegExp){throw new TypeError('First argument to String.prototype.'+b+' must not be a regular expression')}return a+''};$jscomp.polyfill('String.prototype.codePointAt',function(a){if(a){return a}var b=function(b){var e=$jscomp.checkStringArgs(this,null,'codePointAt');var f=e.length;b=Number(b)||0;if(!(b>=0&&b<f)){return void 0}b=b|0;var c=e.charCodeAt(b);if(c<55296||c>56319||b+1===f){return c}var d=e.charCodeAt(b+1);if(d<56320||d>57343){return c}return (c-55296)*1024+d+9216};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.endsWith',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'endsWith');b=b+'';if(c===void 0){c=d.length}var f=Math.max(0,Math.min(c|0,d.length));var e=b.length;while(e>0&&f>0){if(d[--f]!=b[--e]){return !1}}return e<=0};return b},'es6-impl','es3');$jscomp.polyfill('String.fromCodePoint',function(a){if(a){return a}var b=function(e){var c='';for(var d=0;d<arguments.length;d++){var b=Number(arguments[d]);if(b<0||b>1114111||b!==Math.floor(b)){throw new RangeError('invalid_code_point '+b)}if(b<=65535){c+=String.fromCharCode(b)}else {b-=65536;c+=String.fromCharCode(b>>>10&1023|55296);c+=String.fromCharCode(b&1023|56320)}}return c};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.includes',function(a){if(a){return a}var b=function(b,c){var d=$jscomp.checkStringArgs(this,b,'includes');return d.indexOf(b,c||0)!==-1};return b},'es6-impl','es3');$jscomp.polyfill('String.prototype.repeat',function(a){if(a){return a}var b=function(b){var c=$jscomp.checkStringArgs(this,null,'repeat');if(b<0||b>1342177279){throw new RangeError('Invalid count value')}b=b|0;var d='';while(b){if(b&1){d+=c}if(b>>>=1){c+=c}}return d};return b},'es6-impl','es3');$jscomp.stringPadding=function(c,a){var b=c!==undefined?String(c):' ';if(!(a>0)||!b){return ''}var d=Math.ceil(a/b.length);return b.repeat(d).substring(0,a)};$jscomp.polyfill('String.prototype.padEnd',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return b+$jscomp.stringPadding(c,e)};return b},'es8','es3');$jscomp.polyfill('String.prototype.padStart',function(a){if(a){return a}var b=function(d,c){var b=$jscomp.checkStringArgs(this,null,'padStart');var e=d-b.length;return $jscomp.stringPadding(c,e)+b};return b},'es8','es3');$jscomp.polyfill('String.prototype.startsWith',function(a){if(a){return a}var b=function(b,g){var c=$jscomp.checkStringArgs(this,b,'startsWith');b=b+'';var h=c.length;var e=b.length;var f=Math.max(0,Math.min((g)|0,c.length));var d=0;while(d<e&&f<h){if(c[f++]!=b[d++]){return !1}}return d>=e};return b},'es6-impl','es3');$jscomp.arrayFromIterator=function(c){var b;var a=[];while(!(b=c.next()).done){a.push(b.value)}return a};$jscomp.arrayFromIterable=function(a){if(a instanceof Array){return a}else {return $jscomp.arrayFromIterator($jscomp.makeIterator(a))}};$jscomp.inherits=function(a,b){function tempCtor(){}tempCtor.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new tempCtor();a.prototype.constructor=a;for(var c in b){if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);if(d){Object.defineProperty(a,c,d)}}else {a[c]=b[c]}}};$jscomp.polyfill('WeakSet',function(b){function isConformant(){if(!b||!Object.seal){return !1}try{var c=Object.seal({});var d=Object.seal({});var a=new (b)([c]);if(!a.has(c)||a.has(d)){return !1}a['delete'](c);a.add(d);return !a.has(c)&&a.has(d)}catch(e){return !1}}if(isConformant()){return b}var a=function(a){this.map_=new WeakMap();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=$jscomp.makeIterator(a);var c;while(!(c=e.next()).done){var d=c.value;this.add(d)}}};a.prototype.add=function(a){this.map_.set(a,!0);return this};a.prototype.has=function(a){return this.map_.has(a)};a.prototype['delete']=function(a){return this.map_['delete'](a)};return a},'es6-impl','es3');try{if(Array.prototype.values.toString().indexOf('[native code]')==-1){delete Array.prototype.values}}catch(a){}Ext.define('Ext.calendar.EventBase',{extend:'Ext.Gadget',config:{defaultTitle:'(New Event)',endDate:null,mode:null,model:null,palette:null,resize:!1,startDate:null,title:'',touchAction:{panX:!1,panY:!1},view:null},cloneForProxy:function(){var a=new this.self(this.config);a.el.unselectable();return a},updateModel:function(a){var b=this,c;if(a){b.setStartDate(a.getStartDate());b.setEndDate(a.getEndDate());b.setTitle(a.getTitle());c=b.element.dom;c.setAttribute('data-eventId',a.id);c.setAttribute('data-calendarId',a.getCalendarId())}},updateResize:function(a){this.toggleCls(this.$allowResizeCls,a)},privates:{$allowResizeCls:Ext.baseCSSPrefix+'calendar-event-resizable'}});Ext.define('Ext.calendar.Event',{extend:'Ext.calendar.EventBase',xtype:'calendar-event',config:{timeFormat:'H:i'},smallSize:60,getElementConfig:function(){var a=this.callParent();a.cls=Ext.baseCSSPrefix+'calendar-event';a.children=[{cls:Ext.baseCSSPrefix+'calendar-event-inner',reference:'innerElement',children:[{cls:Ext.baseCSSPrefix+'calendar-event-time',reference:'timeElement',children:[{tag:'span',reference:'startElement',cls:Ext.baseCSSPrefix+'calendar-event-time-start'},{tag:'span',html:' - ',reference:'separatorElement',cls:Ext.baseCSSPrefix+'calendar-event-time-separator'},{tag:'span',reference:'endElement',cls:Ext.baseCSSPrefix+'calendar-event-time-end'}]},{reference:'titleElement',tag:'span',cls:Ext.baseCSSPrefix+'calendar-event-title'},{cls:Ext.baseCSSPrefix+'calendar-event-resizer',reference:'resizerElement'}]}];return a},updateEndDate:function(a){this.endElement.setText(this.displayDate(a));this.calculateSize()},updateMode:function(a){var b=this;b.addCls(this.modes[a]);if(a==='weekinline'||a==='weekspan'){b.addCls(b.$inlineTitleCls)}},updatePalette:function(a){var b=this.innerElement.dom.style,c=this.getMode();if(c==='weekspan'||c==='day'){b.backgroundColor=a.primary;b.color=a.secondary;if(c==='day'){this.element.dom.style.borderColor=a.border}}else {b.color=a.primary}},updateStartDate:function(a){this.startElement.setText(this.displayDate(a));this.calculateSize()},updateTitle:function(a){a=a||this.getDefaultTitle();this.titleElement.setText(a)},privates:{$inlineTitleCls:Ext.baseCSSPrefix+'calendar-event-inline-title',modes:{day:Ext.baseCSSPrefix+'calendar-event-day',weekspan:Ext.baseCSSPrefix+'calendar-event-week-span',weekinline:Ext.baseCSSPrefix+'calendar-event-week-inline'},calculateSize:function(){var a=this,d=a.getStartDate(),e=a.getEndDate(),f=a.getView().MS_TO_MINUTES,b=a.getMode()==='day',c;if(!b||d&&e){c=!b||e-d<=a.smallSize*f;a.element.toggleCls(a.$inlineTitleCls,c)}},displayDate:function(a){if(a){a=this.getView().utcToLocal(a);return Ext.Date.format(a,this.getTimeFormat())}}}});Ext.define('Ext.calendar.AbstractList',{extend:'Ext.view.View',updateNavigationModel:function(a,b){a.focusCls=''},onItemClick:function(a,c,b,d){this.callParent([a,c,b,d]);this.handleItemTap(a)}});Ext.define('Ext.calendar.List',{extend:'Ext.calendar.AbstractList',xtype:'calendar-list',config:{enableToggle:!0},cls:Ext.baseCSSPrefix+'calendar-list',itemTpl:'<div class="'+'<tpl if="hidden">'+Ext.baseCSSPrefix+'calendar-list-item-hidden'+'</tpl>">'+'<div class="'+Ext.baseCSSPrefix+'calendar-list-icon" style="background-color: {color};"></div>'+'<div class="'+Ext.baseCSSPrefix+'calendar-list-text">{title:htmlEncode}</div>'+'</div>',itemSelector:'.'+Ext.baseCSSPrefix+'calendar-list-item',itemCls:Ext.baseCSSPrefix+'calendar-list-item',scrollable:!0,prepareData:function(c,b,a){return {id:a.id,editable:a.isEditable(),hidden:a.isHidden(),color:a.getBaseColor(),title:a.getTitle()}},handleItemTap:function(a){if(this.getEnableToggle()){a.setHidden(!a.isHidden())}}});Ext.define('Ext.calendar.date.Range',{end:null,start:null,isRange:!0,statics:{fly:function(){var a=null;return function(b,c){if(b.isRange){return b}if(!a){a=new Ext.calendar.date.Range()}a.start=b;a.end=c;return a}}()},constructor:function(a,b){this.start=a;this.end=b},clone:function(){var a=Ext.Date,b=this.self;return new b(a.clone(this.start),a.clone(this.end))},contains:function(a){return this.start<=a&&a<=this.end},containsRange:function(b,c){var a=this.self.fly(b,c);return a.start>=this.start&&a.end<=this.end},equals:function(b,c){if(!b){return !1}var a=this.self.fly(b,c);return this.start.getTime()===a.start.getTime()&&this.end.getTime()===a.end.getTime()},getDuration:function(){return this.end.getTime()-this.start.getTime()},isContainedBy:function(b,c){var a=this.self.fly(b,c);return a.containsRange(this)},overlaps:function(b,c){var a=this.self.fly(b,c);return a.start<this.end&&this.start<a.end}});Ext.define('Ext.calendar.date.Util',{singleton:!0,clearTimeUtc:function(a,b){if(b){a=Ext.Date.clone(a)}a.setUTCHours(0);a.setUTCMinutes(0);a.setUTCSeconds(0);a.setUTCMilliseconds(0);return a},privates:{getDefaultTimezoneOffset:function(){return (new Date()).getTimezoneOffset()},getLocalNow:function(){return new Date()},expandRange:function(c){var d=Ext.Date,b=c.start,a=c.end;b=d.clone(b);b.setUTCHours(0);if(a.getUTCHours()!==0){a=d.clone(a);a.setUTCHours(24)}return new Ext.calendar.date.Range(b,a)}}});Ext.define('Ext.calendar.dd.WeeksProxy',{extend:'Ext.drag.proxy.Placeholder',alias:'drag.proxy.calendar-weeks',config:{titleTpl:'<tpl if="days &gt; 1">'+'({days} days) '+'</tpl>'+'{title}',width:null},draggingCls:Ext.baseCSSPrefix+'calendar-event-dragging',applyTitleTpl:function(a){if(a&&!a.isXTemplate){a=new Ext.XTemplate(a)}return a},getElement:function(c){var b=this,d=c.view,a=c.widget.cloneForProxy(),e=a.element;a.removeCls(d.$staticEventCls);a.addCls(b.draggingCls);a.addCls(b.placeholderCls);d.element.appendChild(e);a.setWidth(b.getWidth());b.setTitle(a);b.clone=a;return e},cleanup:function(){this.clone=Ext.destroy(this.clone);this.callParent()},privates:{setTitle:function(a){var c=this.getTitleTpl(),b;if(c){b=a.getModel();a.setTitle(c.apply({model:b,title:a.getTitle(),days:this.getSource().getView().getEventDaysSpanned(b)}))}}}});Ext.define('Ext.calendar.util.Dom',{singleton:!0,extractPositions:function(b,d){var e=b.length,c=[],a;for(a=0;a<e;++a){c.push(Ext.fly(b[a])[d]())}return c},getIndexPosition:function(b,e){var d=b.length,c,a;if(e<b[0]){c=0}else {if(e>b[d-1]){c=d-1}else {for(a=d-1;a>=0;--a){if(e>b[a]){c=a;break}}}}return c}});Ext.define('Ext.calendar.dd.DaysAllDaySource',{extend:'Ext.drag.Source',requires:['Ext.calendar.dd.WeeksProxy','Ext.calendar.util.Dom'],activateOnLongPress:'touch',config:{proxy:{type:'calendar-weeks',width:200},view:null},describe:function(a){var c=this.getView(),b=c.getEvent(a.eventTarget);a.event=b;a.widget=c.getEventWidget(b);a.setData('calendar-event-allday',b);a.view=c},beforeDragStart:function(a){return this.getView().handleChangeStart('drag',a.event)},updateView:function(a){if(a){this.setHandle('.'+a.$eventCls);this.setElement(a.allDayContent)}},destroy:function(){this.setView(null);this.callParent()},privates:{setup:function(a){this.callParent([a]);var c=a.view,d=a.event,b=Ext.calendar.util.Dom.extractPositions(c.backgroundCells,'getX');a.index=Ext.calendar.util.Dom.getIndexPosition(b,a.cursor.current.x);a.positions=b;a.span=c.getEventDaysSpanned(d)}}});Ext.define('Ext.calendar.dd.DaysAllDayTarget',{extend:'Ext.drag.Target',requires:['Ext.calendar.util.Dom','Ext.calendar.date.Range'],config:{view:null},updateView:function(a){if(a){this.setElement(a.allDayContent)}},accepts:function(a){return Ext.Array.contains(a.types,'calendar-event-allday')},onDragMove:function(a){var c=a.view,b;if(a.valid){b=Ext.calendar.util.Dom.getIndexPosition(a.positions,a.cursor.current.x);c.selectRange(b,b+a.span-1)}this.callParent([a])},onDragLeave:function(a){this.getView().clearSelected();this.callParent([a])},onDrop:function(b){var a=Ext.Date,e=b.view,d=b.event,i=Ext.calendar.util.Dom.getIndexPosition(b.positions,b.cursor.current.x),f=e.utcTimezoneOffset(a.add(e.dateInfo.full.start,a.DAY,i,!0)),h=d.getStartDate(),g=f<h,c=a.diff(g?f:h,g?h:f,a.DAY);if(g){c=-c}e.handleChange('drop',d,new Ext.calendar.date.Range(a.add(d.getStartDate(),a.DAY,c,!0),a.add(d.getEndDate(),a.DAY,c,!0)),function(){e.clearSelected()});this.callParent([b])},destroy:function(){this.setView(null);this.callParent()}});Ext.define('Ext.calendar.dd.DaysProxy',{extend:'Ext.drag.proxy.Placeholder',alias:'drag.proxy.calendar-days',config:{cursorOffset:null},draggingCls:Ext.baseCSSPrefix+'calendar-event-dragging',getElement:function(b){var e=this,c=b.view,f=b.widget,a=f.cloneForProxy(),d=a.element,g=c.getEventColumn(0);a.removeCls(c.$staticEventCls);a.addCls(e.draggingCls);a.setWidth(Ext.fly(g).getWidth());a.setHeight(f.getHeight());c.bodyWrap.appendChild(d);e.element=d;e.clone=a;b.widgetClone=a;return d},cleanup:function(a){if(a&&a.deferCleanup){return}this.clone=Ext.destroy(this.clone);this.callParent()}});Ext.define('Ext.calendar.dd.DaysBodySource',{extend:'Ext.drag.Source',requires:['Ext.calendar.dd.DaysProxy','Ext.calendar.util.Dom'],activateOnLongPress:'touch',config:{proxy:{type:'calendar-days'},view:null},describe:function(a){var b=this.getView();a.event=b.getEvent(a.eventTarget);a.widget=b.getEventWidget(a.event);a.setData('calendar-event',a.event);a.view=b},beforeDragStart:function(a){var b=this.getView().$resizerCls;if(Ext.fly(a.eventTarget).hasCls(b)){return !1}return this.getView().handleChangeStart('drag',a.event)},updateView:function(b){var a=this;if(b){a.setHandle('.'+b.$eventCls);a.setElement(b.bodyWrap);a.setConstrain({snap:{x:a.snapX,y:a.snapY}})}},onDragStart:function(a){this.callParent([a]);a.widget.element.hide()},onDragEnd:function(a){this.callParent([a]);var b=a.widget;if(!b.destroyed&&!a.deferCleanup){b.element.show()}},destroy:function(){this.setView(null);this.callParent()},privates:{startMarginName:'left',setup:function(a){this.callParent([a]);var b=a.view,e=b.getVisibleDays(),d=[],c;for(c=0;c<e;++c){d.push(Ext.fly(b.getEventColumn(c)).getX())}a.sizes={height:a.proxy.element.getHeight(),slotStyle:b.getSlotStyle(),margin:b.getEventStyle().margin,startPositions:d,startOffset:a.cursor.initial.y-a.widget.element.getY()}},snapX:function(a,e){var d=a.sizes,b=d.startPositions,c=Ext.calendar.util.Dom.getIndexPosition(b,e);a.dayIndex=c;return b[c]+d.margin[a.source.startMarginName]},snapY:function(e,c){var a=e.sizes,f=e.view,b=f.bodyTable.getY(),d=a.slotStyle.halfHeight,g=f.maxSlots,h=Math.max(0,c-a.startOffset-b);c=b+a.margin.top+Ext.Number.roundToNearest(h,d);return Math.min(c,b+g*d-a.height)}}});Ext.define('Ext.calendar.dd.DaysBodyTarget',{extend:'Ext.drag.Target',config:{view:null},updateView:function(a){if(a){this.setElement(a.bodyWrap)}},accepts:function(a){return Ext.Array.contains(a.types,'calendar-event')},onDragMove:function(a){var i=a.sizes,d=a.view,h=a.event,c=Ext.Date,g,b,e,f;if(a.valid){g=Math.max(0,a.proxy.current.y-d.bodyTable.getY());f=Math.floor(g/i.slotStyle.halfHeight);b=c.clone(d.dateInfo.visible.start);b=c.add(b,c.DAY,a.dayIndex||0,!0);b=c.add(b,c.MINUTE,d.minimumEventMinutes*f,!0);e=c.add(b,c.MINUTE,h.getDuration(),!0);a.widgetClone.setStartDate(b);a.widgetClone.setEndDate(e);a.range=[b,e]}this.callParent([a])},onDrop:function(a){var b=this.getView(),c=a.source.getProxy();a.deferCleanup=!0;b.handleChange('drop',a.event,new Ext.calendar.date.Range(a.range[0],a.range[1]),function(){c.cleanup();var d=a.widget;if(!d.destroyed){d.element.show()}b.clearSelected()});this.callParent([a])},destroy:function(){this.setView(null);this.callParent()}});Ext.define('Ext.calendar.dd.WeeksSource',{extend:'Ext.drag.Source',requires:['Ext.calendar.dd.WeeksProxy'],activateOnLongPress:'touch',config:{proxy:{type:'calendar-weeks',width:200},view:null},describe:function(a){var b=this.getView();a.event=b.getEvent(a.eventTarget);a.widget=b.getEventWidget(a.eventTarget);a.setData('calendar-event',a.event);a.view=b},beforeDragStart:function(a){return this.getView().handleChangeStart('drag',a.event)},onDragStart:function(a){var b=a.view,c=a.cursor.current,e=b.getCellByPosition(c.x,c.y),d=a.event;a.span=b.getEventDaysSpanned(d);a.startDate=b.getDateFromCell(e);this.callParent([a])},updateView:function(a){if(a){this.setHandle('.'+a.$eventCls);this.setElement(a.element)}},destroy:function(){this.setView(null);this.callParent()}});Ext.define('Ext.calendar.dd.WeeksTarget',{extend:'Ext.drag.Target',requires:['Ext.calendar.date.Range'],config:{view:null},updateView:function(a){if(a){this.setElement(a.element)}},accepts:function(a){return Ext.Array.contains(a.types,'calendar-event')},onDragMove:function(a){var g=Ext.Date,b=a.view,e=a.cursor.current,h=a.span,f,d,c;if(a.valid){f=b.getCellByPosition(e.x,e.y);d=c=b.getDateFromCell(f);c=g.add(d,g.DAY,h-1,!0);b.selectRange(d,c)}this.callParent([a])},onDragLeave:function(a){this.getView().clearSelected();this.callParent([a])},onDrop:function(a){var d=Ext.Date,f=a.cursor.current,c=a.view,g=c.getCellByPosition(f.x,f.y),b=a.event,e=this.calculateDifference(b,c.getDateFromCell(g),a.startDate);c.handleChange('drop',b,new Ext.calendar.date.Range(d.add(b.getStartDate(),d.DAY,e,!0),d.add(b.getEndDate(),d.DAY,e,!0)),function(){c.clearSelected()});this.callParent([a])},destroy:function(){this.setView(null);this.callParent()},privates:{calculateDifference:function(g,a,f){var e=Ext.Date,d=g.getStartDate(),b,c;if(g.getAllDay()){a=e.localToUtc(a);b=a<d}else {b=a<f;d=f}c=e.diff(b?a:d,b?d:a,e.DAY);if(b){c=-c}return c}}});Ext.define('Ext.calendar.form.CalendarPicker',{extend:'Ext.form.field.ComboBox',xtype:'calendar-calendar-picker',cls:Ext.baseCSSPrefix+'calendar-picker-field',listConfig:{cls:Ext.baseCSSPrefix+'calendar-picker-list',getInnerTpl:function(a){return '<div class="'+Ext.baseCSSPrefix+'calendar-picker-list-icon" style="background-color: {color};"></div>'+'<div class="'+Ext.baseCSSPrefix+'calendar-picker-list-text">{'+a+'}</div>'},prepareData:function(c,b,a){return {id:a.id,title:a.getTitle(),color:a.getBaseColor()}}},afterRender:function(){this.callParent();this.updateValue()},updateValue:function(){var b=this,a,c;b.callParent();c=b.valueCollection.first();if(b.rendered){a=b.iconEl;if(!a){b.iconEl=a=b.inputWrap.createChild({cls:Ext.baseCSSPrefix+'calendar-picker-field-icon'})}if(c){a.setDisplayed(!0);a.setStyle('background-color',c.getBaseColor())}else {a.setDisplayed(!1)}}}});Ext.define('Ext.calendar.form.AbstractForm',{extend:'Ext.window.Window',requires:['Ext.layout.container.Fit','Ext.layout.container.VBox','Ext.layout.container.HBox','Ext.form.Panel','Ext.form.field.Text','Ext.form.field.Date','Ext.form.field.Time','Ext.form.field.Checkbox','Ext.calendar.form.CalendarPicker'],layout:'fit',modal:!0,closable:!1,defaultListenerScope:!0,config:{calendarField:{xtype:'calendar-calendar-picker',fieldLabel:'Calendar',name:'calendarId',forceSelection:!0,editable:!1,queryMode:'local',displayField:'title',valueField:'id'},titleField:{xtype:'textfield',fieldLabel:'Title',name:'title',allowBlank:!1},fromContainer:{xtype:'fieldcontainer',fieldLabel:'From',layout:'hbox'},startDateField:{xtype:'datefield',itemId:'startDate',name:'startDate',allowBlank:!1},startTimeField:{xtype:'timefield',itemId:'startTime',name:'startTime',margin:'0 0 0 5'},toContainer:{xtype:'fieldcontainer',fieldLabel:'To',layout:'hbox'},endDateField:{xtype:'datefield',itemId:'endDate',name:'endDate',allowBlank:!1},endTimeField:{xtype:'timefield',itemId:'endTime',name:'endTime',margin:'0 0 0 5'},allDayField:{xtype:'checkbox',itemId:'allDay',name:'allDay',boxLabel:'All Day',hideEmptyLabel:!1,handler:'onAllDayChange'},descriptionField:{xtype:'textarea',fieldLabel:'Description',name:'description',flex:1},dropButton:{text:'Delete',handler:'onDropTap'},saveButton:{text:'Save',handler:'onSaveTap'},cancelButton:{text:'Cancel',handler:'onCancelTap'}},initComponent:function(){var a=this;a.initForm();a.fbar=a.generateButtons();a.callParent();a.form=a.items.first();a.checkFields();a.applyValues()},generateButtons:function(){var a=[],b=this.getDropButton();if(b){a.push(b)}a.push({xtype:'component',flex:1},this.getSaveButton(),this.getCancelButton());return a},applyValues:function(){this.form.getForm().setValues(this.consumeEventData())},createItems:function(){var a=this,b=a.getCalendarField(),c=a.getFromContainer(),d=a.getToContainer();if(!b.store){b.store=a.getCalendarStore()}if(!c.items){c.items=[a.getStartDateField(),a.getStartTimeField()]}if(!d.items){d.items=[a.getEndDateField(),a.getEndTimeField()]}this.items=[{xtype:'form',border:!1,trackResetOnLoad:!0,layout:{type:'vbox',align:'stretch'},bodyPadding:10,items:[b,a.getTitleField(),c,d,a.getAllDayField(),a.getDescriptionField()]}]},privates:{checkFields:function(){var a=this.down('#allDay').checked;this.down('#startTime').setDisabled(a);this.down('#endTime').setDisabled(a)},onAllDayChange:function(){this.checkFields()},onCancelTap:function(){this.fireCancel()},onDropTap:function(){this.fireDrop()},onSaveTap:function(){var b=this.form,a=b.getForm().getFieldValues();if(!b.isValid()){return}a.allDay=this.down('#allDay').checked;this.fireSave(this.produceEventData(a))}}});Ext.define('Ext.calendar.form.Base',{extend:'Ext.Mixin',requires:['Ext.data.ChainedStore'],config:{event:null,view:null},fireCancel:function(){this.fireEvent('cancel',this)},fireDrop:function(){this.fireEvent('drop',this)},fireSave:function(a){this.fireEvent('save',this,{data:a})},getCalendarStore:function(){return {type:'chained',autoDestroy:!0,source:this.getView().getStore(),filters:[{filterFn:function(a){return a.isEditable()}}]}}});Ext.define('Ext.calendar.form.Form',{extend:'Ext.calendar.form.AbstractForm',mixins:['Ext.calendar.form.Base'],defaultStartTime:[9,0],defaultEndTime:[10,0],initForm:function(){this.createItems()},consumeEventData:function(){var c=this,f=Ext.Date,i=c.getView(),b=c.getEvent(),j=b.getStartDate(),k=b.getEndDate(),d=b.getAllDay(),g=d?f.utcToLocal(j):i.utcToLocal(j),e=d?f.utcToLocal(k):i.utcToLocal(k),l=d||g.getTime()===e.getTime(),a={calendarId:b.getCalendarId(),title:b.getTitle(),description:b.getDescription(),allDay:d,startDate:g,endDate:e},h;if(!l){a.startTime=g;a.endTime=e}if(d){a.endDate=f.subtract(e,f.DAY,1,!0)}c.setDefaultTime(a,'startTime',c.defaultStartTime);c.setDefaultTime(a,'endTime',c.defaultEndTime);if(!a.calendarId){h=i.getEditableCalendars();if(h.length){a.calendarId=h[0].id}}return a},produceEventData:function(a){var d=Ext.Date,m=this.getView(),e=a.startTime,f=a.endTime,b=a.startDate,c=a.endDate,l=b.getFullYear(),h=b.getMonth(),k=b.getDate(),j=c.getFullYear(),g=c.getMonth(),i=c.getDate();if(a.allDay){b=d.utc(l,h,k);c=d.add(d.utc(j,g,i),d.DAY,1,!0);delete a.startTime;delete a.endTime}else {b=m.toUtcOffset(new Date(l,h,k,e.getHours(),e.getMinutes()));c=m.toUtcOffset(new Date(j,g,i,f.getHours(),f.getMinutes()))}a.startDate=b;a.endDate=c;return a},privates:{setDefaultTime:function(a,c,b){if(!a[c]){a[c]=new Date(2010,0,1,b[0],b[1])}}}});Ext.define('Ext.calendar.form.Add',{extend:'Ext.calendar.form.Form',xtype:'calendar-form-add',dropButton:null,title:'Add Event'});Ext.define('Ext.calendar.form.Edit',{extend:'Ext.calendar.form.Form',xtype:'calendar-form-edit',title:'Edit Event'});Ext.define('Ext.calendar.header.Base',{extend:'Ext.Gadget',mixins:['Ext.mixin.ConfigState'],alternateStateConfig:'compactOptions',config:{cellCls:'',compact:!1,compactOptions:null,format:'',value:null,visibleDays:null},baseCls:Ext.baseCSSPrefix+'calendar-header',constructor:function(a){this.callParent([a]);this.redrawCells()},updateCompact:function(b){var a=this,c=a.baseCls;a.element.toggleCls(c+'-compact',b);a.element.toggleCls(c+'-large',!b);a.toggleConfigState(b)},updateCompactOptions:function(){if(!this.isConfiguring&&this.getCompact()){this.toggleConfigState()}},updateFormat:function(){if(!this.isConfiguring){this.setHeaderText(!0)}},applyValue:function(a,b){if(a&&b&&a-b===0){a=undefined}return a},updateValue:function(){if(!this.isConfiguring){this.setHeaderText()}},updateVisibleDays:function(){if(!this.isConfiguring){this.redrawCells()}},getElementConfig:function(){return {tag:'table',cls:this.$tableCls,reference:'element',children:[{tag:'tbody',children:[{tag:'tr',reference:'row'}]}]}},privates:{domFormat:'Y-m-d',useDates:!0,$headerCls:Ext.baseCSSPrefix+'calendar-header-cell',$hiddenCls:Ext.baseCSSPrefix+'calendar-header-hidden-cell',$tableCls:Ext.baseCSSPrefix+'calendar-header-table',clearCells:function(a){a=a||0;var c=this.row.dom,b=c.childNodes;while(b.length>a){c.removeChild(b[a])}},createCells:function(){var b=this,h=b.row.dom,e=[],g=b.getCreateDays(),f=Ext.baseCSSPrefix+'unselectable '+b.$headerCls,d=b.getCellCls(),a,c;if(d){f+=' '+d}for(c=0;c<g;++c){a=document.createElement('td');a.className=f;a.setAttribute('data-index',c);b.onCellCreate(a,c);h.appendChild(a);e.push(a)}return e},getCreateDays:function(){return this.getVisibleDays()},onCellCreate:Ext.privateFn,redrawCells:function(){this.clearCells();this.cells=this.createCells();this.setHeaderText()},setHeaderText:function(){var b=this,c=Ext.Date,a=b.getValue(),i=b.getFormat(),g=b.domFormat,f=b.cells,j=f.length,h=b.useDates,d,e;if(!a){return}a=c.clone(a);for(e=0;e<j;++e){d=f[e];if(h){d.setAttribute('data-date',c.format(a,g))}d.setAttribute('data-day',a.getDay());d.innerHTML=c.format(a,i);a=c.add(a,c.DAY,1,!0)}}}});Ext.define('Ext.calendar.header.Days',{extend:'Ext.calendar.header.Base',xtype:'calendar-daysheader',format:'D m/d',compactOptions:{format:'d'},getElementConfig:function(){var a=this.callParent();a.cls=this.$tableCls;delete a.reference;return {cls:Ext.baseCSSPrefix+'calendar-header',reference:'element',children:[a]}},privates:{headerScrollOffsetName:'padding-right',$gutterCls:Ext.baseCSSPrefix+'calendar-header-gutter',createCells:function(){var a=this,b=a.row,c=a.callParent();b.insertFirst({tag:'td',cls:a.$headerCls+' '+a.$gutterCls});b.append({tag:'td',style:'display: none;'});return c},setOverflowWidth:function(a){this.element.setStyle(this.headerScrollOffsetName,a+'px')}}});Ext.define('Ext.calendar.header.Weeks',{extend:'Ext.calendar.header.Base',xtype:'calendar-weeksheader',format:'D',privates:{useDates:!1,getCreateDays:function(){return Ext.Date.DAYS_IN_WEEK},onCellCreate:function(b,a){Ext.fly(b).toggleCls(this.$hiddenCls,a>=this.getVisibleDays())}}});Ext.define('Ext.calendar.model.EventBase',{extend:'Ext.Mixin',requires:['Ext.calendar.date.Range'],inheritableStatics:{getDaysSpanned:function(a,d){var b=Ext.Date,c=0;a=b.clearTime(a,!0);while(a<d){++c;a=b.add(a,b.DAY,1,!0)}return c},sort:function(a,b){return a.getStartDate().getTime()-b.getStartDate().getTime()||b.getDuration()-a.getDuration()||a.getTitle()-b.getTitle()}},containsRange:function(a,b){return this.getRange().containsRange(a,b)},getCalendar:function(){return this.calendar||null},getRange:function(){return new Ext.calendar.date.Range(this.getStartDate(),this.getEndDate())},isContainedByRange:function(a,b){return this.getRange().isContainedBy(a,b)},isSpan:function(){return this.getAllDay()||this.getDuration()>=1440},occursInRange:function(a,b){return this.getRange().overlaps(a,b)},setCalendar:function(a,b){b=b!==!1;this.calendar=a;this.setCalendarId(a?a.id:null,b)}});Ext.define('Ext.calendar.model.Event',{extend:'Ext.data.Model',mixins:['Ext.calendar.model.EventBase'],requires:['Ext.data.field.String','Ext.data.field.Integer','Ext.data.field.Date','Ext.data.field.Boolean'],fields:[{name:'title',type:'string'},{name:'calendarId'},{name:'color',type:'string'},{name:'description',type:'string'},{name:'startDate',type:'date',dateFormat:'c'},{name:'endDate',type:'date',dateFormat:'c'},{name:'allDay',type:'boolean'},{name:'duration',type:'int',depends:['startDate','endDate'],calculate:function(b){var a=b.startDate,c=b.endDate,d=0;if(c&&a){d=c.getTime()-a.getTime()}return d/60000}}],getAllDay:function(){return this.data.allDay},getCalendarId:function(){return this.data.calendarId},getColor:function(){return this.data.color},getDescription:function(){return this.data.description},getDuration:function(){return this.data.duration},getEndDate:function(){return this.data.endDate},getRange:function(){var a=this,b=a.range;if(!b){a.range=b=new Ext.calendar.date.Range(a.getStartDate(),a.getEndDate())}return b},getStartDate:function(){return this.data.startDate},getTitle:function(){return this.data.title},isEditable:function(){var a=this.getCalendar();return a?a.isEditable():!0},setAllDay:function(a){this.set('allDay',a)},setCalendarId:function(b,a){a=a!==!1;this.set('calendarId',b,{dirty:a})},setColor:function(a){this.set('color',a)},setData:function(a){var b=a.duration;if(b){a=Ext.apply({},a);delete a.duration;this.setDuration(b)}else {if(a.startDate&&a.endDate){this.range=null}}this.set(a)},setDescription:function(a){this.set('description',a)},setDuration:function(b){var a=Ext.Date;this.range=null;this.set('endDate',a.add(this.data.startDate,a.MINUTE,b,!0))},setRange:function(a,b){var c=Ext.Date;if(a.isRange){b=a.end;a=a.start}this.range=null;this.set({startDate:c.clone(a),endDate:c.clone(b)})},setTitle:function(a){this.set('title',a)}});Ext.define('Ext.calendar.store.Events',{extend:'Ext.data.Store',alias:'store.calendar-events',model:'Ext.calendar.model.Event',requires:['Ext.calendar.model.Event','Ext.calendar.date.Range'],config:{calendar:null,calendarParam:'calendar',dateFormat:'C',endParam:'endDate',prefetchMode:'month',startParam:'startDate'},remoteSort:!1,pageSize:0,sorters:[{direction:'ASC',sorterFn:function(a,b){return Ext.calendar.model.Event.sort(a,b)}}],prefetchSettings:{month:{unit:Ext.Date.MONTH,amount:2},week:{unit:Ext.Date.WEEK,amount:2},day:{unit:Ext.Date.DAY,amount:4}},constructor:function(a){this.requests={};this.callParent([a])},getInRange:function(e,f){var c=this.data.items,g=c.length,d=[],a,b;for(a=0;a<g;++a){b=c[a];if(b.occursInRange(e,f)){d.push(b)}}return d},hasRangeCached:function(c){var a=this.range,b=!1;if(a){b=a.full.containsRange(c)}return b},setRange:function(h){var b=this,l=Ext.Date,m=Ext.calendar.date.Range,c=b.range,d=b.getPrefetchSetting(),f=l.subtract(h.start,d.unit,d.amount,!0),g=l.add(h.end,d.unit,d.amount,!0),a={actual:h.clone(),full:new m(f,g)},e=0,k=!1,i,j;if(b.compareRange(c,a)){return}if(c&&c.full.containsRange(a.full)){return}if(b.hasRangeCached(h)){if(!b.hasRangeCached(a.full)){if(c.full.start>f){i=f;j=c.full.start;++e;k=!0}if(c.full.end<g){i=c.full.end;j=g;++e}if(e===1){b.prefetchRange(i,j,k,a)}else {if(e===2){b.loadRange(f,g,a)}}}}else {b.loadRange(a.full.start,a.full.end,a)}b.requested=a},onProxyLoad:function(b){var a=this;if(b.wasSuccessful()){a.range=a.requested;a.requested=null}a.setCalendarFromLoad=!0;a.callParent([b]);a.setCalendarFromLoad=!1},onCollectionAdd:function(c,b){var a=this;a.setRecordCalendar(a.getCalendar(),b.items,!a.setCalendarFromLoad);a.callParent([c,b])},onCollectionRemove:function(b,a){this.callParent([b,a]);if(!this.isMoving){this.setRecordCalendar(null,a.items,!0)}},privates:{isMoving:0,abortAll:function(){var a=this.requests,b;for(b in a){a[b].abort()}this.requests={}},compareRange:function(a,b){var c=!1;if(!a||!b){c=(a||null)===(b||null)}else {c=a.full.equals(b.full)&&a.actual.equals(b.actual)}return c},getPrefetchSetting:function(){return this.prefetchSettings[this.getPrefetchMode()]},loadRange:function(c,d,e){var a=this,b=a.requested,f=new Ext.calendar.date.Range(c,d);if(!(b&&b.full.equals(f))){a.abortAll();a.load({params:a.setupParams(c,d),requested:e})}},onBeforeLoad:function(a){this.requests[a._internalId]=a},onPrefetch:function(d){var a=this,e=d.getRecords()||[],f=[],g=[],l=Ext.Array.toMap(e,'id'),i=a.getDataSource().getRange(),h=i.length,j=a.range.full.start,k=a.range.full.end,b,c;if(d.wasSuccessful()){a.range=a.requested;a.requested=null}delete a.requests[d._internalId];a.suspendEvents();for(b=0;b<h;++b){c=i[b];if(!(l[c.id]||c.occursInRange(j,k))){f.push(c)}}for(b=0,h=e.length;b<h;++b){c=e[b];if(!a.getById(c.id)){g.push(c)}}a.ignoreCollectionRemove=a.setCalendarFromLoad=!0;a.getData().splice(0,f,g);a.ignoreCollectionRemove=a.setCalendarFromLoad=!1;a.resumeEvents();a.fireEvent('prefetch',a,g,f)},prefetch:function(c){var a=this,b;c=Ext.apply({internalScope:a,internalCallback:a.onPrefetch},c);a.setLoadOptions(c);b=a.createOperation('read',c);a.requests[b._internalId]=b;b.execute()},prefetchRange:function(c,d,b,a){this.prefetch({params:this.setupParams(c,d),isLeading:b,newRequested:a})},setRecordCalendar:function(d,c,e){var f=c.length,b,a;for(b=0;b<f;++b){a=c[b];a.$moving=!0;a.setCalendar(d,e);delete a.$moving}},setupParams:function(e,f){var a=this,d=Ext.Date,c=a.getDateFormat(),b={};b[a.getCalendarParam()]=a.getCalendar().id;b[a.getStartParam()]=d.format(e,c);b[a.getEndParam()]=d.format(f,c);return b}}});Ext.define('Ext.calendar.theme.Theme',{singleton:!0,requires:['Ext.util.Color'],colors:['#F44336','#3F51B5','#4CAF50','#FF9800','#E91E63','#2196F3','#8BC34A','#FF5722','#673AB7','#009688','#FFC107','#607D8B'],lightColor:'#FFFFFF',darkColor:'#000000',generatePalette:function(b){var a=this,c=a.light,i=a.dark,g=a.lightColor,h=a.darkColor,f=b.getBrightness(),e,d;if(!c){a.light=c=Ext.util.Color.fromString(g);a.dark=i=Ext.util.Color.fromString(h)}e=Math.abs(c.getBrightness()-f);d=Math.abs(i.getBrightness()-f);return {primary:b.toString(),secondary:e>d?g:h,border:b.createDarker(0.2).toString()}},getBaseColor:function(f){var b=this,d=b.idMap,c=b.colors,e=f.id,a;a=d[e];if(!a){a=c[b.current%c.length];d[e]=a;++b.current}return a},getPalette:function(b){var c=this.colorMap,a=c[b],d;if(!a){d=Ext.util.Color.fromString(b);c[b]=a=this.generatePalette(d)}return a},privates:{colorMap:{},idMap:{},current:0,onIdChanged:function(d,b){var a=this.idMap,c=a[b];if(c){delete a[b];a[d]=c}}}});Ext.define('Ext.calendar.model.CalendarBase',{extend:'Ext.Mixin',requires:['Ext.calendar.store.Events','Ext.calendar.theme.Theme'],config:{eventStoreDefaults:{type:'calendar-events',proxy:{type:'ajax'}}},events:function(){var a=this,b=a._eventStore,c;if(!b){c=Ext.merge({calendar:a},a.config.eventStoreDefaults,a.eventStoreDefaults);a._eventStore=b=Ext.Factory.store(a.getEventStoreConfig(c))}return b},getBaseColor:function(){var a=this.getColor()||this.getAssignedColor();if(!a){a=Ext.calendar.theme.Theme.getBaseColor(this);this.setAssignedColor(a)}return a},isEditable:function(){return this.getEditable()},isHidden:function(){return this.getHidden()},privates:{onIdChanged:function(a,b){Ext.calendar.theme.Theme.onIdChanged(a,b)}}});Ext.define('Ext.calendar.model.Calendar',{extend:'Ext.data.Model',mixins:['Ext.calendar.model.CalendarBase'],requires:['Ext.data.field.String','Ext.data.field.Boolean'],fields:[{name:'title',type:'string'},{name:'description',type:'string'},{name:'color',type:'string'},{name:'assignedColor',type:'string',persist:!1},{name:'hidden',type:'bool'},{name:'editable',type:'bool',defaultValue:!0},{name:'eventStore',type:'auto',persist:!1}],constructor:function(b,a){this.callParent([b,a]);this.getBaseColor()},getAssignedColor:function(){return this.data.assignedColor},getColor:function(){return this.data.color},getDescription:function(){return this.data.description},getEditable:function(){return this.data.editable},getEventStoreConfig:function(a){return Ext.merge(a,this.data.eventStore)},getHidden:function(){return this.data.hidden},getTitle:function(){return this.data.title},setAssignedColor:function(a){this.set('assignedColor',a)},setColor:function(a){this.set('color',a)},setDescription:function(a){this.set('description',a)},setEditable:function(a){this.set('editable',a)},setHidden:function(a){this.set('hidden',a)},setTitle:function(a){this.set('title',a)}});Ext.define('Ext.calendar.panel.AbstractBase',{extend:'Ext.panel.Panel',requires:['Ext.layout.container.Fit'],layout:'fit',updateDayHeader:function(a){if(a){this.addItem(a,'dockedItems','addDocked')}},updateView:function(a){this.addItem(a,'items','add')},afterComponentLayout:function(d,c,b,a){this.callParent([d,c,b,a]);this.syncHeaders()},privates:{addItem:function(d,c,e){var b=this,a=b[c];if(a){if(a.isMixedCollection){b[e](d)}else {if(!Ext.isArray(a)){a=[a]}b[c]=a.concat(d)}}else {b[c]=d}},syncHeaders:function(){var b=this,a;if(b.syncHeaderSize){a=b.getDayHeader();if(a&&a.setOverflowWidth){a.setOverflowWidth(b.getView().scrollable.getScrollbarSize().width)}}}}});Ext.define('Ext.calendar.panel.Base',{extend:'Ext.calendar.panel.AbstractBase',config:{dayHeader:null,eventRelayers:{view:{beforeeventadd:!0,beforeeventedit:!0,eventadd:!0,eventedit:!0,eventdrop:!0,eventtap:!0,validateeventadd:!0,validateeventedit:!0,validateeventdrop:!0,valuechange:!0}},view:null},platformConfig:{'!desktop':{compact:!0}},configExtractor:{view:{addForm:!0,compact:!0,compactOptions:!0,controlStoreRange:!0,editForm:!0,eventDefaults:!0,gestureNavigation:!0,store:!0,timezoneOffset:!0,value:!0}},twoWayBindable:{value:1},cls:[Ext.baseCSSPrefix+'calendar-base',Ext.baseCSSPrefix+'unselectable'],constructor:function(a){var c=this,j=Ext.Config,i=c.configExtractor,h={},f,b,e,g,d;a=Ext.apply({},a);c.extracted=h;for(f in i){e=i[f];h[f]=g={};for(b in a){if(b in e){d=e[b];if(d===!0){d=b}g[d]=a[b];delete a[b]}}c.setupProxy(e,j.get(f).names.get)}c.callParent([a]);c.initRelayers()},onClassExtended:function(c,b,d){var a=b.configExtractor;if(a){delete b.configExtractor;c.prototype.configExtractor=Ext.merge({},c.prototype.configExtractor,a)}},getDisplayRange:function(){return this.getView().getDisplayRange()},getVisibleRange:function(){return this.getView().getVisibleRange()},moveNext:function(){this.getView().moveNext()},movePrevious:function(){this.getView().movePrevious()},navigate:function(b,a){this.getView().navigate(b,a)},showAddForm:function(b,a){this.getView().showAddForm(b,a)},showEditForm:function(b,a){this.getView().showEditForm(b,a)},applyDayHeader:function(a){if(a){a=Ext.apply(this.extracted.dayHeader,a);a=Ext.create(a)}return a},updateDayHeader:function(b,a){if(a){a.destroy()}if(b){this.getView().setHeader(b)}this.callParent([b,a])},applyView:function(a){if(a){a=Ext.create(Ext.apply(this.extracted.view,a))}return a},updateView:function(b,a){if(a){a.destroy()}this.callParent([b,a])},privates:{calculateMoveNext:function(){return this.getView().calculateMoveNext()},calculateMovePrevious:function(){return this.getView().calculateMovePrevious()},createItemRelayer:function(b){var a=this;return function(d,c){return a.fireEvent(b,a,c)}},generateProxyMethod:function(d,c,b){var a=this,h=c.names.set,g=c.names.get,f=d.names.set,e=d.names.get;if(!a[f]){a[f]=function(f){var e=a[b]();if(e){e[h](f)}}}if(!a[e]){a[e]=function(){var e=a[b]();if(e){return e[g]()}}}},initRelayers:function(){var g=Ext.Config,d=this.getEventRelayers(),c,a,f,b,e;for(c in d){a=d[c];f=this[g.get(c).names.get]();e=a.$prefix||'';for(b in a){f.on(b,this.createItemRelayer(e+b))}}},refreshEvents:function(){this.getView().refreshEvents()},setupProxy:function(e,g){var h=this,f=Ext.Config,c,a,b,d;for(c in e){d=e[c];b=f.get(c);if(d===!0){a=b}else {a=f.get(d)}h.generateProxyMethod(b,a,g)}}}});Ext.define('Ext.calendar.store.EventSource',{extend:'Ext.data.Store',requires:['Ext.calendar.date.Range'],config:{source:null},sorters:[{direction:'ASC',sorterFn:function(a,b){return Ext.calendar.model.Event.sort(a,b)}}],trackRemoved:!1,constructor:function(a){this.calendarMap={};this.callParent([a])},createEvent:function(b){var c=this.getSource().first().events().getModel(),a=new c();if(b){a.setData(b)}return a},updateSource:function(b){var a=this;a.sourceListeners=Ext.destroy(a.sourceListeners);if(b){a.sourceListeners=b.on({destroyable:!0,scope:a,add:'checkData',remove:'checkData',refresh:'checkData'});a.checkData()}},add:function(b){var a=this.getEventsForCalendar(b.getCalendarId());if(!a){return}a.add(b)},move:function(b,e){var a=this.getEventsForCalendar(e),c=b.getCalendar(),d;if(c){a.suspendAutoSync();++a.isMoving}a.remove(b);if(c){--a.isMoving;a.resumeAutoSync();b.unjoin(a);d=a.removed;if(d){Ext.Array.remove(d,b)}a=this.getEventsForCalendar(c);a.suspendAutoSync();a.add(b);a.resumeAutoSync()}},remove:function(b){var a=this.getEventsForCalendar(b.getCalendarId());if(!a){return}a.remove(b)},hasRangeCached:function(c){var e=this.calendarMap,a=this.range,f,d,b;if(!a){return !1}for(f in e){b=!0;d=this.getEventsForCalendar(e[f]);if(!d.hasRangeCached(c)){return !1}}if(!b){return a.containsRange(c)}return !0},setRange:function(g){var a=this,i=a.calendarMap,e=!0,d=!0,f,c,j,b,h;a.range=g.clone();for(j in i){h=!0;c=a.getEventsForCalendar(i[j]);f=c.hasRangeCached(g);d=d&&f;c.setRange(g);if(!f){b=b||[];c.on('load',function(d,f,c){Ext.Array.remove(b,d);e=e&&c;if(b.length===0){a.doBulkLoad(e)}},null,{single:!0});b.push(c);a.activeLoad=!0}}if(h&&d){a.checkData(!0)}else {if(b){a.fireEvent('beforeload',a)}}},doDestroy:function(){var a=this,b=this.calendarMap,c;for(c in b){a.untrackCalendar(b[c])}a.calendarMap=a.stores=null;a.setSource(null);a.callParent()},privates:{checkData:function(m){var a=this,e=a.calendarMap,g=Ext.apply({},e),n=a.getSource(),i=n.getRange(),o=i.length,j=[],c=a.range,f,b,d,h,k,l;if(c){k=c.start;l=c.end}for(f=0;f<o;++f){d=i[f];b=d.getId();if(g[b]){delete g[b];a.untrackCalendar(e[b])}a.trackCalendar(d);if(c){h=a.getEventsForCalendar(d);if(h.getCount()){Ext.Array.push(j,h.getInRange(k,l))}}e[b]=d}for(b in g){a.untrackCalendar(g[b]);delete e[b]}if(m!==!0&&c){a.setRange(c)}a.loadRecords(j)},doBulkLoad:function(c){var a=this,f=a.calendarMap,e=a.range,b=[],g,d;if(c){for(g in f){d=a.getEventsForCalendar(f[g]);Ext.Array.push(b,d.getInRange(e.start,e.end))}a.loadRecords(b)}a.fireEvent('load',a,b,c);a.activeLoad=!1},fireChangeEvent:function(){return !1},getEventsForCalendar:function(a){var b=null;if(!a.isModel){a=this.calendarMap[a]}if(a){b=a.events()}return b},onEventStoreAdd:function(g,d){var e=this.range,f=d.length,b=[],a,c;for(a=0;a<f;++a){c=d[a];if(c.occursInRange(e.start,e.end)){b.push(c)}}if(b.length>0){this.getDataSource().add(b)}},onEventStoreBeforeUpdate:function(b,a){if(!a.$moving){this.suspendEvents();this.lastIndex=this.indexOf(a)}},onEventStoreClear:function(d,b){var a=this,c;if(b.length>0){a.suspendEvents();c=a.getDataSource().remove(b);a.resumeEvents();if(c){a.fireEvent('refresh',a)}}},onEventStorePrefetch:function(c,b,a){this.getDataSource().remove(a)},onEventStoreRefresh:function(){if(this.activeLoad){return}this.checkData()},onEventStoreRemove:function(b,a){this.getDataSource().remove(a)},onEventStoreUpdate:function(j,b,h,e,g){if(b.$moving){return}var a=this,i=a.range,f=a.lastIndex,c=a.lastIndex!==-1,d=a.contains(b);a.resumeEvents();if(c&&d){a.fireEvent('update',a,b,h,e,g)}else {if(c&&!d){a.fireEvent('remove',a,[b],f,!1)}else {if(!c&&d){a.fireEvent('add',a,[b],a.indexOf(b))}}}},trackCalendar:function(b){var a=this.getEventsForCalendar(b);a.sourceListeners=a.on({destroyable:!0,scope:this,add:'onEventStoreAdd',beforeupdate:'onEventStoreBeforeUpdate',clear:'onEventStoreClear',prefetch:'onEventStorePrefetch',refresh:'onEventStoreRefresh',remove:'onEventStoreRemove',update:'onEventStoreUpdate'})},untrackCalendar:function(b){var a=this.getEventsForCalendar(b);a.sourceListeners=Ext.destroy(a.sourceListeners)}}});Ext.define('Ext.calendar.store.Calendars',{extend:'Ext.data.Store',alias:'store.calendar-calendars',requires:['Ext.calendar.store.EventSource','Ext.calendar.model.Calendar'],config:{eventStoreDefaults:null},model:'Ext.calendar.model.Calendar',getEventSource:function(){var a=this.eventSource;if(!a){this.eventSource=a=new Ext.calendar.store.EventSource({source:this})}return a},onCollectionAdd:function(f,d){var e=this.getEventStoreDefaults(),c=d.items,g=c.length,b,a;this.callParent([f,d]);if(e){for(b=0;b<g;++b){a=c[b];if(!a.hasOwnProperty('eventStoreDefaults')){a.eventStoreDefaults=Ext.merge({},a.eventStoreDefaults,e)}}}},doDestroy:function(){this.eventSource=Ext.destroy(this.eventSource);this.callParent()}});Ext.define('Ext.calendar.view.Base',{extend:'Ext.Gadget',requires:['Ext.calendar.store.Calendars','Ext.calendar.theme.Theme','Ext.calendar.Event','Ext.Promise','Ext.calendar.date.Range','Ext.calendar.date.Util'],mixins:['Ext.mixin.ConfigState'],alternateStateConfig:'compactOptions',config:{addForm:{xtype:'calendar-form-add'},compact:!1,compactOptions:null,controlStoreRange:!0,editForm:{xtype:'calendar-form-edit'},eventDefaults:{xtype:'calendar-event'},gestureNavigation:!0,header:null,store:null,timezoneOffset:undefined,value:undefined},platformConfig:{'!desktop':{compact:!0}},twoWayBindable:{value:1},constructor:function(a){this.eventMap={};this.eventPool={};this.callParent([a])},getForm:function(){return this.form||null},moveNext:function(){this.setValue(this.calculateMoveNext())},movePrevious:function(){this.setValue(this.calculateMovePrevious())},navigate:function(a,c){var b=Ext.Date;if(a!==0){this.setValue(b.add(this.getValue(),c||b.DAY,a,!0))}},showAddForm:function(b,e){var a=this,d=Ext.Date,c;if(a.getAddForm()){if(!b){c=a.getDefaultCreateRange();b=a.createModel({startDate:c.start,endDate:d.add(c.end,d.DAY,1,!0),allDay:!0})}a.doShowForm(b,'add',a.createAddForm(),'onFormCreateSave',e)}},showEditForm:function(b,a){if(this.getEditForm()){this.doShowForm(b,'edit',this.createEditForm(),'onFormEditSave',a)}},createAddForm:function(){return Ext.merge({view:this},this.getAddForm())},createEditForm:function(a){return Ext.merge({view:this},this.getEditForm())},getEventSource:function(){return this.eventSource},updateCompact:function(b){var a=this,c=a.baseCls,d=a.getHeader();a.toggleCls(Ext.baseCSSPrefix+'calendar-compact',b);a.toggleCls(c+'-compact',b);a.toggleCls(Ext.baseCSSPrefix+'calendar-large',!b);a.toggleCls(c+'-large',!b);if(d){d.setCompact(b)}a.toggleConfigState(b)},updateCompactOptions:function(){if(!this.isConfiguring&&this.getCompact()){this.toggleConfigState(!0)}},updateGestureNavigation:function(b){var a;if(Ext.supports.Touch){a=b?'on':'un';this.getBodyElement()[a]('swipe','onBodySwipe',this)}},updateHeader:function(b,a){if(a){a.destroy()}if(b){b.setCompact(this.getCompact());this.refreshHeaders()}},applyStore:function(a){if(a){a=Ext.StoreManager.lookup(a,'calendar-calendars')}return a},updateStore:function(c,b){var a=this;a.eventSource=null;if(b){if(b.getAutoDestroy()){b.destroy()}else {b.getEventSource().un(a.getSourceListeners());b.un(a.getStoreListeners())}}if(c){c.on(a.getStoreListeners());a.eventSource=c.getEventSource();a.eventSource.on(a.getSourceListeners());if(!a.isConfiguring){a.onSourceAttach();a.refreshEvents()}}},applyTimezoneOffset:function(a){this.autoOffset=!1;if(a===undefined){a=Ext.calendar.date.Util.getDefaultTimezoneOffset();this.autoOffset=!0}return a},applyValue:function(a,b){a=Ext.Date.clearTime(a||Ext.calendar.date.Util.getLocalNow(),!0);if(b&&b.getTime()===a.getTime()){a=undefined}return a},updateValue:function(a){if(!this.isConfiguring){this.fireEvent('valuechange',this,{value:a})}},doDestroy:function(){var a=this;a.clearEvents();a.form=Ext.destroy(a.form);a.setHeader(null);a.setStore(null);a.callParent()},privates:{$eventCls:Ext.baseCSSPrefix+'calendar-event',$eventInnerCls:Ext.baseCSSPrefix+'calendar-event-inner',$eventColorCls:Ext.baseCSSPrefix+'calendar-event-marker-color',$staticEventCls:Ext.baseCSSPrefix+'calendar-event-static',$tableCls:Ext.baseCSSPrefix+'calendar-table',eventRefreshSuspend:0,refreshCounter:0,forwardDirection:'left',backwardDirection:'right',dateInfo:null,calculateMove:function(b){var a=this.getMoveInterval(),c=this.getMoveBaseValue();return Ext.Date.add(c,a.unit,b*a.amount,!0)},calculateMoveNext:function(){return this.calculateMove(1)},calculateMovePrevious:function(){return this.calculateMove(-1)},clearEvents:function(){var b=this.eventMap,a;for(a in b){b[a].destroy()}this.eventMap={}},createEvent:function(f,a,e){var b=this,g=Ext.apply({},b.getEventDefaults()),c,d;if(e){d=b.getUtcNow();a.startDate=d;a.endDate=d}else {a.palette=b.getEventPalette(f)}a=a||{};a.model=f;a.view=b;c=Ext.widget(Ext.apply(a,g));if(!e){b.eventMap[c.id]=c}return c},createEvents:function(b,d){var e=b.length,c=[],a;for(a=0;a<e;++a){c.push(this.createEvent(b[a],Ext.apply({},d)))}return c},createModel:function(a){return this.getEventSource().createEvent(a)},doRefresh:Ext.privateFn,doRefreshEvents:Ext.privateFn,doShowForm:function(c,d,g,f,b){var a=this,e;if(!a.getStore()||!c.isEditable()){return}if(a.fireEvent('beforeevent'+d,a,{event:c})===!1){return}b=b||{};a.form=e=Ext.create(Ext.apply({event:c},g));e.on({save:function(h,j){var e=j.data,i={event:c,data:e,validate:Ext.Promise.resolve(!0)};a.fireEvent('validateevent'+d,a,i);i.validate.then(function(i){if(i!==!1){if(b.onSave){b.onSave.call(b.scope||a,a,c,e)}a[f](h,c,e);a.fireEvent('event'+d,a,{event:c,data:e})}else {a.onFormCancel(h)}})},cancel:function(e,h){if(b.onCancel){b.onCancel.call(b.scope||a,a,c)}a.onFormCancel(e);a.fireEvent('event'+d+'cancel',a,{event:c})},close:function(e){if(b.onCancel){b.onCancel.call(b.scope||a,a,c)}a.onFormCancel(e)},drop:function(e){var h={event:c,validate:Ext.Promise.resolve(!0)};a.fireEvent('validateeventdrop',a,h);h.validate.then(function(h){if(h!==!1){if(b.onDrop){b.onDrop.call(b.scope||a,a,c)}a.onFormDrop(e,c);a.fireEvent('eventdrop',a,{event:c})}else {a.onFormCancel(e)}})}});e.show()},getBodyElement:function(){return this.element},getCalendar:function(a){return this.getStore().getById(a)},getDaysSpanned:function(a,b,e){var d=Ext.Date,c;if(e){c=d.diff(a,b,d.DAY)}else {a=this.utcToLocal(a);b=this.utcToLocal(b);c=Ext.calendar.model.Event.getDaysSpanned(a,b)}return c},getDefaultCreateRange:function(){var c=this,a=Ext.calendar.date.Util.getLocalNow(),d=c.getDisplayRange(),b;a=c.toUtcOffset(Ext.Date.clearTime(a,!0));if(d.contains(a)){b=Ext.Date.localToUtc(a)}else {b=c.toUtcOffset(d.start)}return new Ext.calendar.date.Range(b,b)},getDefaultPalette:function(){var d=this.getStore(),b=Ext.calendar.theme.Theme,a,c;if(d){a=d.first();if(a){c=a.getBaseColor()}}return b.getPalette(c||b.colors[0])},getEditableCalendars:function(){var a=this.getStore(),b;if(a){b=Ext.Array.filter(a.getRange(),function(a){return a.isEditable()})}return b||[]},getEvent:function(a){var b=this.$eventCls,c;if(a.isEvent){a=a.target}if(!Ext.fly(a).hasCls(b)){a=Ext.fly(a).up('.'+b,this.element,!0)}c=a.getAttribute('data-eventId');return this.getEventSource().getById(c)},getEventDaysSpanned:function(a){return this.getDaysSpanned(a.getStartDate(),a.getEndDate(),a.getAllDay())},getEventPalette:function(a){var b=a.getColor()||a.getCalendar().getBaseColor();return Ext.calendar.theme.Theme.getPalette(b)},getMoveBaseValue:function(){return this.getValue()},getMoveInteral:Ext.privateFn,getSourceListeners:function(){return {scope:this,add:'onSourceAdd',refresh:'onSourceRefresh',remove:'onSourceRemove',update:'onSourceUpdate'}},getStoreListeners:function(){return {scope:this,update:'onStoreUpdate'}},getUtcNow:function(){return Ext.Date.utcToLocal(new Date())},handleChange:function(e,c,b,d){var a=this,g={event:c,newRange:b.clone(),validate:Ext.Promise.resolve(!0)},f=d?d:Ext.emptyFn;a.fireEvent('validateevent'+e,a,g);g.validate.then(function(g){if(g!==!1){f(!0);c.setRange(b);a.fireEvent('event'+e,a,{event:c,newRange:b.clone()})}else {f(!1)}})},handleChangeStart:function(c,b){var a=b.isEditable();if(a){a=this.fireEvent('beforeevent'+c+'start',this,{event:b})}return a},handleResize:Ext.privateFn,hasEditableCalendars:function(){return this.getEditableCalendars().length>0},isEventHidden:function(b){var a=b.getCalendar();return a?a.isHidden():!0},onBodySwipe:function(b){var a=this;if(b.direction===a.forwardDirection){a.moveNext()}else {if(b.direction===a.backwardDirection){a.movePrevious()}}},onEventTap:function(a){this.fireEvent('eventtap',this,{event:a});this.showEditForm(a)},onFormCreateSave:function(c,a,b){a.setData(b);a.setCalendar(this.getCalendar(a.getCalendarId()));this.getEventSource().add(a);this.form=Ext.destroy(c)},onFormEditSave:function(f,b,e){var a=this,d=b.getCalendar(),c;a.suspendEventRefresh();b.setData(e);c=b.getCalendarId();if(d.id!==c){b.setCalendar(a.getCalendar(c));a.getEventSource().move(b,d)}a.resumeEventRefresh();a.refreshEvents();a.form=Ext.destroy(f)},onFormDrop:function(b,a){this.getEventSource().remove(a);this.form=Ext.destroy(b)},onFormCancel:function(a){this.form=Ext.destroy(a)},onSourceAdd:function(){this.refreshEvents()},onSourceAttach:Ext.privateFn,onSourceRefresh:function(){this.refreshEvents()},onSourceRemove:function(){this.refreshEvents()},onSourceUpdate:function(){this.refreshEvents()},onStoreUpdate:function(){this.refreshEvents()},refresh:function(){var a=this;if(!a.isConfiguring){++a.refreshCounter;a.doRefresh();if(a.hasListeners.refresh){a.fireEvent('refresh',a)}}},refreshEvents:function(){var a=this;if(!a.eventRefreshSuspend&&!a.isConfiguring){if(!a.refreshCounter){a.refresh()}a.doRefreshEvents()}},refreshHeaders:Ext.privateFn,resumeEventRefresh:function(){--this.eventRefreshSuspend},setSourceRange:function(a){if(!this.getControlStoreRange()){return}var b=this.getEventSource(),c;if(b){a=Ext.calendar.date.Util.expandRange(a);c=b.hasRangeCached(a);b.setRange(a);if(c){this.refreshEvents()}}},suspendEventRefresh:function(){++this.eventRefreshSuspend},toUtcOffset:function(e){var c=Ext.Date,f=c.localToUtc(e),d=this.autoOffset,a=d?f.getTimezoneOffset():this.getTimezoneOffset(),b;if(d){b=e.getTimezoneOffset();if(b!==a){a+=b-a}}return c.add(f,c.MINUTE,a,!0)},utcToLocal:function(c){var b=Ext.Date,e=this.getTimezoneOffset(),d=c.getTimezoneOffset(),a;if(this.autoOffset){a=b.clone(c)}else {a=b.subtract(c,b.MINUTE,e-d,!0)}return a},utcTimezoneOffset:function(a){var b=Ext.Date,c=this.autoOffset?a.getTimezoneOffset():this.getTimezoneOffset();return b.subtract(a,b.MINUTE,c,!0)}}});Ext.define('Ext.overrides.calendar.view.Base',{override:'Ext.calendar.view.Base',constructor:function(a){this.callParent([a]);this.initialized=!0},render:function(b,c){var a=this;a.callParent([b,c]);if(a.initialized&&!a.getRefOwner()){a.refresh()}},afterComponentLayout:function(d,c,b,a){this.callParent([d,c,b,a]);this.handleResize()},privates:{refreshEvents:function(){if(this.element.dom.offsetHeight===0){return}this.callParent()}}});Ext.define('Ext.calendar.view.DaysRenderer',{end:null,start:null,view:null,constructor:function(d){var b=this,a,c;Ext.apply(b,d);a=b.view;c=a.slotTicks;b.slots=(a.getEndTime()-a.getStartTime())*(60/c);b.offset=a.MS_TO_MINUTES*c;b.events=[]},addIf:function(a){var b=this,e=b.start,g=b.view,f=b.offset,c,d;if(!a.isSpan()&&a.isContainedByRange(e,b.end)){c=Math.max(0,(g.roundDate(a.getStartDate())-e)/f);d=Math.min(b.slots,(g.roundDate(a.getEndDate())-e)/f);this.events.push({event:a,start:c,end:d,len:d-c,colIdx:-1,overlaps:[],edgeWeight:-1,forwardPos:-1,backwardPos:-1})}},calculate:function(){var b=this,f=b.events,d,e,a,c;f.sort(b.sortEvents);d=b.buildColumns(f);b.constructOverlaps(d);c=d[0];if(c){e=c.length;for(a=0;a<e;++a){b.calculateEdgeWeights(c[a])}for(a=0;a<e;++a){b.calculatePositions(c[a],0,0)}}},hasEvents:function(){return this.events.length>0},privates:{appendOverlappingEvents:function(a,b){this.doOverlap(a,b,a.overlaps)},buildColumns:function(g){var h=g.length,b=[],e,c,f,d,a;for(e=0;e<h;++e){a=-1;d=g[e];for(c=0,f=b.length;c<f;++c){if(!this.hasOverlappingEvents(d,b[c])){a=c;break}}if(a===-1){a=b.length;b[a]=[]}b[a].push(d);d.colIdx=a}return b},calculateEdgeWeights:function(c){var d=c.overlaps,e=d.length,a=c.edgeWeight,b;if(a===-1){a=0;for(b=0;b<e;++b){a=Math.max(a,this.calculateEdgeWeights(d[b])+1)}c.edgeWeight=a}return a},calculatePositions:function(a,j,h){var b=a.overlaps,i=b.length,f=j+1,c,d,e,g;if(a.forwardPos===-1){if(i===0){a.forwardPos=1}else {b.sort(this.sortOverlaps);e=b[0];this.calculatePositions(e,f,h);a.forwardPos=e.backwardPos}c=a.forwardPos;g=c-h;a.backwardPos=c-g/f;for(d=1;d<i;++d){this.calculatePositions(b[d],0,c)}}},constructOverlaps:function(d){var h=d.length,e,a,b,c,f,g;for(a=0;a<h;++a){e=d[a];for(b=0,f=e.length;b<f;++b){g=e[b];for(c=a+1;c<h;++c){this.appendOverlappingEvents(g,d[c])}}}},doOverlap:function(f,c,d){var g=c.length,e=!1,a,b;for(a=0;a<g;++a){b=c[a];if(this.overlaps(f,b)){if(d){d.push(b);e=!0}else {return !0}}}return e},hasOverlappingEvents:function(b,a){return this.doOverlap(b,a)},overlaps:function(a,b){return a.start<b.end&&a.end>b.start},sortEvents:function(a,b){return Ext.calendar.model.EventBase.sort(a.event,b.event)},sortOverlaps:function(a,b){return b.edgeWeight-a.edgeWeight||(a.backwardPos||0)-(b.backwardPos||0)||Ext.calendar.model.EventBase.sort(a.event,b.event)}}});Ext.define('Ext.calendar.view.Days',{extend:'Ext.calendar.view.Base',xtype:'calendar-daysview',requires:['Ext.calendar.view.DaysRenderer','Ext.calendar.Event','Ext.scroll.Scroller','Ext.calendar.util.Dom'],uses:['Ext.calendar.dd.DaysAllDaySource','Ext.calendar.dd.DaysAllDayTarget','Ext.calendar.dd.DaysBodySource','Ext.calendar.dd.DaysBodyTarget'],isDaysView:!0,baseCls:Ext.baseCSSPrefix+'calendar-days',cellOverflowScrollBug:Ext.isGecko||Ext.isIE11m||Ext.isEdge,config:{allowSelection:!0,compactOptions:{displayOverlap:!1,showNowMarker:!1,timeFormat:'g',timeRenderer:function(f,e,d){var g=Ext.Date,b='',a,c;if(d){c=Ext.baseCSSPrefix+'calendar-days-time-ampm';a=g.clone(this.baseDate);a.setHours(f);b='<div class="'+c+'">'+Ext.Date.format(a,'a')+'</div>'}return e+b}},displayOverlap:!0,draggable:!0,droppable:!0,endTime:20,resizeEvents:!0,showNowMarker:!0,startTime:8,timeFormat:'H:i',timeRenderer:null,visibleDays:4},constructor:function(b){var a=this;a.slotsPerHour=60/a.slotTicks;a.callParent([b]);a.scrollable=a.createScroller();a.bodyTable.on('tap','handleEventTap',a,{delegate:'.'+a.$eventCls});a.allDayContent.on('tap','handleEventTap',a,{delegate:'.'+a.$eventCls});a.recalculate();a.refreshHeaders()},getDisplayRange:function(){var a=this,b;if(a.isConfiguring){a.recalculate()}b=a.dateInfo.active;return new Ext.calendar.date.Range(a.utcToLocal(b.start),a.utcToLocal(b.end))},getVisibleRange:function(){var b=Ext.Date,a;if(this.isConfiguring){this.recalculate()}a=this.dateInfo.active;return new Ext.calendar.date.Range(b.clone(a.start),b.clone(a.end))},setTimeRange:function(b,c){var a=this;a.isConfiguring=!0;a.setStartTime(b);a.setEndTime(c);this.isConfiguring=!1;a.suspendEventRefresh();a.recalculate();a.resumeEventRefresh();a.refresh()},updateAllowSelection:function(b){var a=this;a.allDaySelectionListeners=a.selectionListeners=Ext.destroy(a.selectionListeners,a.allDaySelectionListeners);if(b){a.bodySelectionListeners=a.bodyTable.on({destroyable:!0,scope:a,touchstart:'onBodyTouchStart',touchmove:'onBodyTouchMove',touchend:'onBodyTouchEnd'});a.allDaySelectionListeners=a.headerWrap.on({destroyable:!0,scope:a,touchstart:'onAllDayTouchStart',touchmove:'onAllDayTouchMove',touchend:'onAllDayTouchEnd'})}},updateDisplayOverlap:function(a){if(!this.isConfiguring){this.refreshEvents()}},applyDraggable:function(a){if(a){a=new Ext.calendar.dd.DaysBodySource()}return a},updateDraggable:function(c,b){var a=this;if(b){b.destroy();a.allDayDrag=Ext.destroy(a.allDayDrag)}if(c){c.setView(a);a.allDayDrag=new Ext.calendar.dd.DaysAllDaySource();a.allDayDrag.setView(a)}},applyDroppable:function(a){if(a&&!a.isInstance){a=new Ext.calendar.dd.DaysBodyTarget(a)}return a},updateDroppable:function(c,b){var a=this;if(b){b.destroy();a.allDayDrop=Ext.destroy(a.allDayDrop)}if(c){c.setView(a);a.allDayDrop=new Ext.calendar.dd.DaysAllDayTarget();a.allDayDrop.setView(a)}},updateEndTime:function(){this.calculateSlots();if(!this.isConfiguring){this.refresh()}},updateResizeEvents:function(b){var a=this;a.dragListeners=Ext.destroy(a.dragListeners);if(b){a.dragListeners=a.bodyTable.on({scope:a,dragstart:'onResizerDragStart',drag:'onResizerDrag',dragend:'onResizerDragEnd',destroyable:!0,delegate:'.'+a.$resizerCls,priority:1001})}if(!(a.isConfiguring||a.destroying)){a.refreshEvents()}},updateShowNowMarker:function(c){var a=this,b=a.markerEl;Ext.uninterval(a.showNowInterval);a.showNowInterval=null;a.markerEl=null;if(b){Ext.fly(b).remove()}if(c){if(!a.isConfiguring){a.checkNowMarker()}a.showNowInterval=Ext.interval(a.checkNowMarker,300000,a)}},updateStartTime:function(){this.calculateSlots();if(!this.isConfiguring){this.refresh()}},updateTimeFormat:function(){if(!this.isConfiguring){this.updateTimeLabels()}},updateTimeRenderer:function(){if(!this.isConfiguring){this.updateTimeLabels()}},updateTimezoneOffset:function(){if(!this.isConfiguring){this.recalculate()}},updateValue:function(c,b){var a=this;if(!a.isConfiguring){a.recalculate();a.refreshHeaders();a.checkNowMarker();a.refreshEvents()}a.callParent([c,b])},updateVisibleDays:function(){var a=this;if(!a.isConfiguring){a.suspendEventRefresh();a.recalculate();a.resumeEventRefresh();a.refresh()}},getElementConfig:function(){var a=this,b=a.callParent(),c=[{tag:'table',cls:a.$tableCls+' '+a.$bodyTableCls,reference:'bodyTable',children:[{tag:'tbody',children:[{tag:'tr',reference:'timeRow',children:[{tag:'td',reference:'timeContainer',cls:a.$timeContainerCls}]}]}]}];b.children=[{cls:Ext.baseCSSPrefix+'calendar-days-table-wrap',reference:'tableWrap',children:[{cls:Ext.baseCSSPrefix+'calendar-days-header-wrap',reference:'headerWrap',children:[{cls:Ext.baseCSSPrefix+'calendar-days-allday-background-wrap',reference:'allDayBackgroundWrap',children:[{tag:'table',cls:a.$tableCls+' '+Ext.baseCSSPrefix+'calendar-days-allday-background-table',children:[{tag:'tbody',children:[{tag:'tr',reference:'allDayBackgroundRow',children:[{tag:'td',cls:a.$headerGutterCls}]}]}]}]},{tag:'table',cls:a.$tableCls+' '+Ext.baseCSSPrefix+'calendar-days-allday-events',children:[{tag:'tbody',reference:'allDayContent',children:[{tag:'tr',reference:'allDayEmptyRow'}]}]}]},{cls:Ext.baseCSSPrefix+'calendar-days-body-row',children:[{cls:Ext.baseCSSPrefix+'calendar-days-body-cell',reference:a.cellOverflowScrollBug?null:'bodyWrap',children:a.cellOverflowScrollBug?[{cls:Ext.baseCSSPrefix+'calendar-days-body-wrap',reference:'bodyWrap',children:c}]:c}]}]}];return b},doDestroy:function(){var a=this;a.scrollable=Ext.destroy(a.scrollable);a.setAllowSelection(!1);a.setShowNowMarker(!1);a.setResizeEvents(!1);a.callParent()},privates:{$allDayBackgroundCls:Ext.baseCSSPrefix+'calendar-days-allday-background-cell',$allDayEmptyRowCls:Ext.baseCSSPrefix+'calendar-days-allday-empty-cell',$bodyCls:Ext.baseCSSPrefix+'calendar-days-body',$bodyTableCls:Ext.baseCSSPrefix+'calendar-days-body-table',$dayColumnCls:Ext.baseCSSPrefix+'calendar-days-day-column',$dayEventContainerCls:Ext.baseCSSPrefix+'calendar-days-day-event-container',$headerGutterCls:Ext.baseCSSPrefix+'calendar-days-header-gutter',$markerAltCls:Ext.baseCSSPrefix+'calendar-days-marker-alt',$markerCls:Ext.baseCSSPrefix+'calendar-days-marker',$nowMarkerCls:Ext.baseCSSPrefix+'calendar-days-now-marker',$resizerCls:Ext.baseCSSPrefix+'calendar-event-resizer',$resizingCls:Ext.baseCSSPrefix+'calendar-event-resizing',$selectionCls:Ext.baseCSSPrefix+'calendar-days-selection',$tableCls:Ext.baseCSSPrefix+'calendar-days-table',$timeCls:Ext.baseCSSPrefix+'calendar-days-time',$timeContainerCls:Ext.baseCSSPrefix+'calendar-days-time-ct',baseDate:new Date(2008,0,1),MS_TO_MINUTES:60000,minimumEventMinutes:30,slotTicks:5,slotsPerHour:null,backPosName:'left',forwardPosName:'right',headerScrollOffsetName:'padding-right',calculateSlots:function(){this.maxSlots=(this.getEndTime()-this.getStartTime())*2},checkNowMarker:function(){if(this.getShowNowMarker()){this.doCheckNowMarker()}},clearAndPopulate:function(b,e,f){var c=b.dom.childNodes,g=e.length,d=f?0:1,a;while(c.length>d){b.removeChild(c[d])}for(a=0;a<g;++a){b.appendChild(e[a],!0)}},clearEvents:function(){this.callParent();var b=this.allDayContent.dom,a=b.childNodes;while(a.length>1){b.removeChild(a[0])}},clearSelected:function(){this.selectRange(-1,-1)},constructAllDayEvents:function(n){var a=this,r=Ext.Date,l=n.length,q=a.getVisibleDays(),d=a.allDayEmptyRow.dom,i=a.allDayContent.dom,c,e,b,p,m,h,g,j,o,k,f;c=new Ext.calendar.view.WeeksRenderer({view:a,start:r.clone(this.dateInfo.full.start),days:q,index:0,maxEvents:null});for(b=0;b<l;++b){e=n[b];if(!a.isEventHidden(e)&&e.isSpan()){c.addIf(e)}}if(d.firstChild.className===a.$headerGutterCls){d.removeChild(d.firstChild)}if(c.hasEvents()){c.calculate();p=c.rows;for(b=0,l=p.length;b<l;++b){m=c.compress(b);k=document.createElement('tr');for(h=0,o=m.length;h<o;++h){g=m[h];f=document.createElement('td');f.colSpan=g.len;if(!g.isEmpty){j=a.createEvent(g.event,{},!1);j.addCls(a.$staticEventCls);f.appendChild(j.element.dom)}k.appendChild(f)}i.insertBefore(k,d)}}Ext.fly(i.firstChild).insertFirst({tag:'td',cls:a.$headerGutterCls,rowSpan:i.childNodes.length})},constructEvents:function(){var a=this,d=Ext.Date,g=a.getEventSource().getRange(),m=g.length,k=a.getVisibleDays(),b=d.clone(a.dateInfo.visible.start),j=b,l=a.getEndTime()-a.getStartTime(),e,f,c,i,h;a.constructAllDayEvents(g);for(e=0;e<k;++e){j=d.add(b,d.HOUR,l,!0);i=document.createDocumentFragment();c=new Ext.calendar.view.DaysRenderer({view:a,start:b,end:j});for(f=0;f<m;++f){h=g[f];if(!a.isEventHidden(h)){c.addIf(h)}}if(c.hasEvents()){c.calculate();a.processDay(c,i)}a.getEventColumn(e).appendChild(i);b=d.add(b,d.DAY,1,!0)}},createEvent:function(b,a,d){a=a||{};var c=b?b.getAllDay():!1;a.mode=c?'weekspan':'day';if(!c){a.resize=this.getResizeEvents()}return this.callParent([b,a,d])},createScroller:function(){return new Ext.scroll.Scroller({element:this.bodyWrap,x:!1,y:!0})},doCheckNowMarker:function(){var a=this,d=Ext.Date,i=a.markerEl,c=a.roundDate(Ext.calendar.date.Util.getLocalNow()),k=a.dateInfo.visible,b=a.utcToLocal(k.start),n=a.utcToLocal(k.end),m=a.getVisibleDays(),r=c.getFullYear(),q=c.getMonth(),p=c.getDate(),g=c.getHours(),o=c.getMinutes(),h=a.getStartTime(),j=a.getEndTime(),l,f,e;if(i){Ext.fly(i).remove()}a.markerEl=null;if(!a.element.isVisible(!0)){return}if(b<=c&&c<n){for(e=0;e<m;++e){if(b.getFullYear()===r&&b.getMonth()===q&&b.getDate()===p){if(h<=g&&(g<j||g===j&&o===0)){b.setHours(h);l=d.diff(b,c,d.MINUTE);f=l/a.slotTicks*a.getSlotStyle().minSlotHeight}break}b=d.add(b,d.DAY,1,!0)}}if(f!==undefined){a.markerEl=Ext.fly(a.getColumn(e)).createChild({cls:a.$nowMarkerCls,style:{top:f+'px'}},null,!0)}},doRecalculate:function(b){var c=this,a=Ext.Date,e=Ext.calendar.date.Range,d,f;if(!b){b=a.clone(c.getValue())}b=c.toUtcOffset(a.clearTime(b,!0));d=a.add(b,a.DAY,c.getVisibleDays(),!0);f=a.subtract(d,a.DAY,1,!0);return {full:new e(b,d),active:new e(b,f),visible:new e(a.add(b,a.HOUR,c.getStartTime(),!0),a.subtract(d,a.HOUR,24-c.getEndTime(),!0))}},doRefresh:function(){var a=this,b=a.timeContainer,d=a.allDayBackgroundRow,c;if(!a.dateInfo){a.suspendEventRefresh();a.recalculate();a.resumeEventRefresh()}b.dom.innerHTML='';b.appendChild(a.generateTimeElements());a.clearAndPopulate(a.allDayEmptyRow,a.generateAllDayCells(a.$allDayEmptyRowCls,'&#160;'),!0);a.clearAndPopulate(d,a.generateAllDayCells(a.$allDayBackgroundCls));a.clearAndPopulate(a.timeRow,a.generateColumns());c=Ext.Array.toArray(a.allDayBackgroundRow.dom.childNodes);a.backgroundCells=Ext.Array.slice(c,1);a.checkNowMarker();a.refreshHeaders();a.syncHeaderScroll();a.refreshEvents()},doRefreshEvents:function(){var a=this.getEventSource();this.clearEvents();if(a&&a.getCount()){this.constructEvents()}},generateAllDayCells:function(e,d){var b=[],c=this.getVisibleDays(),a;for(a=0;a<c;++a){b.push({tag:'td',cls:e,html:d})}return b},generateColumns:function(){var a=this,h=a.getVisibleDays(),g=a.getStartTime(),i=a.getEndTime(),f=[],e,b,d,c;for(b=0;b<h;++b){c=[];e={tag:'td',cls:a.$dayColumnCls,'data-index':b,children:[{cls:a.$dayEventContainerCls},{cls:a.$markerContainerCls,children:c}]};for(d=g;d<i;++d){c.push({cls:a.$markerCls,children:[{cls:a.$markerAltCls}]})}f.push(e)}return f},generateTimeElements:function(){var b=this.generateTimeLabels(),d=b.length,c=[],a;for(a=0;a<d;++a){c.push({cls:this.$timeCls,html:b[a]})}return c},generateTimeLabels:function(){var b=this,j=Ext.Date,f=j.clone(b.baseDate),l=b.getStartTime(),m=b.getEndTime(),k=b.getTimeFormat(),i=[],e=b.getTimeRenderer(),g,h,d,a,c;for(a=l;a<m;++a){f.setHours(a);d=j.format(f,k);if(e){c=!1;if(a<12&&!g){c=g=!0}else {if(a>=12&&!h){c=h=!0}}d=e.call(this,a,d,c)}i.push(d)}return i},getBodyElement:function(){return this.bodyTable},getColumn:function(a){return this.getColumns()[a]},getColumns:function(){return this.bodyTable.query('.'+this.$dayColumnCls)},getEventColumn:function(a){return Ext.fly(this.getColumn(a)).down('.'+this.$dayEventContainerCls)},getEventStyle:function(){var c=this,d=c.eventStyle,e,b,a;if(!d){e=c.createEvent(null,{resize:!0},!0);b=e.element;b.dom.style.visibility='hidden';c.getEventColumn(0).appendChild(b.dom);a=b.getMargin();a.height=a.top+a.bottom;c.eventStyle=d={margin:a,resizerWidth:Ext.fly(b.down('.'+this.$resizerCls,!0)).getWidth()};e.destroy()}return d},getEventWidget:function(d){var c=this.eventMap,e=d.id,b,a;for(b in c){a=c[b];if(a.getModel().id===e){return a}}return null},getMoveInterval:function(){return {unit:Ext.Date.DAY,amount:this.getVisibleDays()}},getSlotStyle:function(){var a=this,c=a.slotStyle,b;if(!c){b=Ext.fly(a.bodyTable.down('.'+a.$markerCls,!0)).getHeight();a.slotStyle=c={hourHeight:b,halfHeight:b/2,minSlotHeight:b/a.slotsPerHour}}return c},handleEventTap:function(b){var a=this.getEvent(b);if(a){this.onEventTap(a)}},handleResize:function(){var a=this;a.slotStyle=null;a.callParent();a.refreshEvents();a.checkNowMarker();a.syncHeaderScroll()},onAllDayTouchEnd:function(j){var b=this,a=Ext.Date,d=b.isAllDayCreating,f,g,c,e,h,i;if(d){f=d.initialIndex;g=Ext.calendar.util.Dom.getIndexPosition(d.positions,j.pageX);c=d.startDate;h=Math.abs(g-f);if(f>g){e=c;c=a.subtract(e,a.DAY,h,!0)}else {e=a.add(c,a.DAY,h,!0)}i=b.createModel({startDate:a.localToUtc(c),endDate:a.add(a.localToUtc(e),a.DAY,1,!0),allDay:!0});b.showAddForm(i,{scope:b,onSave:b.clearSelected,onCancel:b.clearSelected});b.isAllDayCreating=null}},onAllDayTouchMove:function(e){var d=this,a=d.isAllDayCreating,b,c;if(!a){return}b=a.initialIndex;c=Ext.calendar.util.Dom.getIndexPosition(a.positions,e.pageX);d.selectRange(b,c)},onAllDayTouchStart:function(d){var a=this,e=Ext.Date,c,b,f=this.utcToLocal(a.dateInfo.full.start);if(d.pointerType==='touch'||d.getTarget('.'+a.$eventCls,a.headerWrap)){return}c=Ext.calendar.util.Dom.extractPositions(a.backgroundCells,'getX');b=Ext.calendar.util.Dom.getIndexPosition(c,d.pageX);a.isAllDayCreating={positions:c,initialIndex:b,startDate:e.add(f,e.DAY,b,!0)};a.selectRange(b,b)},onBodyTouchEnd:function(h){var b=this,d=b.isBodyCreating,a,c,e,f,g;if(d){a=d.widget;if(a){f=a.getStartDate();g=a.getEndDate();c=function(){a.destroy()};e=b.createModel({startDate:f,endDate:g});b.showAddForm(e,{onSave:c,onCancel:c})}b.isBodyCreating=null}},onBodyTouchMove:function(n){var b=this,i=Ext.Date,e=b.isBodyCreating,k=b.minimumEventMinutes,l=b.getEventStyle().margin,h,a,c,d,f,j,g,m;if(!e){return}a=e.widget;if(!a){a=b.createEvent(null,{},!0);h=a.element;a.setPalette(b.getDefaultPalette());a.addCls(b.$resizingCls);a.setWidth('100%');h.setZIndex(999);b.getEventColumn(e.index).appendChild(h);e.widget=a}h=a.element;c=b.slotFromPosition(n.getY());if(c<0||c>b.maxSlots){return}d=e.startSlot;if(d===c){c=d+1}if(d>c){f=c;j=d}else {f=d;j=c}h.setStyle({top:l.top+b.slotToPosition(f)+'px',marginTop:0,marginBottom:0});a.setHeight((j-f)*b.getSlotStyle().halfHeight-l.bottom);g=i.clone(e.baseDate);g=i.add(g,i.MINUTE,f*k,!0);m=i.add(g,i.MINUTE,(j-f)*k,!0);a.setStartDate(g);a.setEndDate(m)},onBodyTouchStart:function(c){var a=this,e=Ext.Date,b,d,f;if(c.pointerType==='touch'||c.getTarget('.'+a.$eventCls,a.bodyTable)){return}b=c.getTarget('.'+a.$dayColumnCls);if(b){d=parseInt(b.getAttribute('data-index'),10);f=e.add(a.dateInfo.visible.start,e.DAY,d,!0);a.isBodyCreating={col:b,index:d,baseDate:f,startSlot:a.slotFromPosition(c.getY())}}},onResizerDrag:function(g){if(!this.resizing){return}var c=this,f=Ext.Date,a=c.resizing,k=a.event,h=a.widget,i=c.getSlotStyle().halfHeight,b=c.slotFromPosition(g.getY()),m=b*i-a.eventTop,d=a.startSlot,l=k.getStartDate(),j=c.minimumEventMinutes,e;g.stopEvent();if(b<0||b>c.maxSlots||b<=d){return}a.current=e=f.add(l,f.MINUTE,j*(b-d),!0);h.setHeight(m);h.setEndDate(e)},onResizerDragEnd:function(){if(!this.resizing){return}var c=this,h=Ext.calendar.date.Range,a=c.resizing,f=a.current,b=a.widget,g=a.height,d=a.event,e=function(e){if(!b.destroyed){b.element.setZIndex(a.oldZIndex);b.removeCls(c.$resizingCls)}if(!e){b.setHeight(g);b.setEndDate(d.getEndDate())}};c.resizing=null;if(f){c.handleChange('resize',d,new h(d.getStartDate(),f),e)}else {e()}},onResizerDragStart:function(f){var a=this,d=a.getEvent(f),b,c,e;f.stopEvent();if(a.handleChangeStart('resize',d)!==!1){b=a.getEventWidget(d);c=b.element;e=c.getTop(!0);a.resizing={height:b.getHeight(),event:d,eventTop:e,startSlot:a.slotFromPosition(e,!0),widget:b,oldZIndex:c.getZIndex()};b.addCls(a.$resizingCls);c.setZIndex(999)}},onSourceAttach:function(){this.recalculate()},processDay:function(q,p){var b=this,l=q.events,r=l.length,k=b.getSlotStyle().minSlotHeight,j=b.getEventStyle(),m=j.margin,h=0,i=b.getDisplayOverlap(),f,a,g,n,o,e,d,c;if(b.getResizeEvents()){h=j.resizerWidth+5}for(f=0;f<r;++f){a=l[f];e=a.forwardPos;d=a.backwardPos;if(i){e=Math.min(1,d+(e-d)*2)}n=d;o=1-e;g=b.createEvent(a.event);c={marginTop:0,marginBottom:0,top:a.start*k+m.top+'px',zIndex:a.colIdx+1};c[b.backPosName]=n*100+'%';c[b.forwardPosName]=o*100+'%';if(i&&a.edgeWeight>0){c.marginRight=h+'px'}g.setStyle(c);g.setHeight(a.len*k-m.bottom);p.appendChild(g.element.dom)}},recalculate:function(){var a=this.doRecalculate();this.dateInfo=a;this.setSourceRange(a.full)},refreshHeaders:function(){var a=this,b=a.getHeader(),c=a.dateInfo;if(b){b.setVisibleDays(a.getVisibleDays());if(c){b.setValue(a.utcToLocal(c.full.start))}}},roundDate:function(a){return new Date(Ext.Number.roundToNearest(a.getTime(),this.slotTicks))},selectRange:function(b,c){var d=this.backgroundCells,e=d.length,a;if(b>c){a=b;b=c;c=a}for(a=0;a<e;++a){Ext.fly(d[a]).toggleCls(this.$selectionCls,a>=b&&a<=c)}},slotFromPosition:function(b,a){var c=b-(a?0:this.bodyTable.getY());return Math.round(c/this.getSlotStyle().halfHeight)},slotToPosition:function(a){return a*this.getSlotStyle().halfHeight},syncHeaderScroll:function(){var a=this,c=a.scrollable,d=a.headerScrollOffsetName,b,e;if(c){b=c.getScrollbarSize().width+'px';a.headerWrap.setStyle(d,b);a.allDayBackgroundWrap.setStyle(d,b)}},updateTimeLabels:function(){var b=this.generateTimeLabels(),c=this.timeContainer.dom.childNodes,a;for(a=0,len=b.length;a<len;++a){c[a].innerHTML=b[a]}}}});Ext.define('Ext.overrides.calendar.view.Days',{override:'Ext.calendar.view.Days',requires:['Ext.calendar.form.Edit','Ext.calendar.form.Add'],privates:{doRefresh:function(){this.setBodyWrapSize();this.callParent();this.updateLayout()},doRefreshEvents:function(){var a=this,b=a.bodyWrap;a.callParent();a.setBodyWrapSize();a.syncHeaderScroll();a.fireEvent('eventrefresh',a,{})},setBodyWrapSize:function(){var b=this.tableWrap,c=this.bodyWrap,a;if(Ext.isIE10m){a=Ext.fly(b.dom.parentNode).getHeight();b.setHeight(a);c.setHeight(a-this.headerWrap.getHeight())}}}});Ext.define('Ext.calendar.panel.Days',{extend:'Ext.calendar.panel.Base',xtype:'calendar-days',requires:['Ext.calendar.header.Days','Ext.calendar.view.Days','Ext.scroll.Scroller'],config:{dayHeader:{xtype:'calendar-daysheader'},eventRelayers:{view:{beforeeventdragstart:!0,validateeventdrop:!0,eventdrop:!0,beforeeventresizestart:!0,validateeventresize:!0,eventresize:!0}},view:{xtype:'calendar-daysview'}},configExtractor:{dayHeader:{dayHeaderFormat:'format'},view:{allowSelection:!0,displayOverlap:!0,draggable:!0,droppable:!0,endTime:!0,resizeEvents:!0,showNowMarker:!0,startTime:!0,timeFormat:!0,visibleDays:!0}},setTimeRange:function(a,b){this.getView().setTimeRange(a,b)},privates:{syncHeaderSize:!0}});Ext.define('Ext.overrides.calendar.panel.Days',{override:'Ext.calendar.panel.Days',updateView:function(a,b){this.callParent([a,b]);a.on('eventrefresh','onEventRefresh',this)},privates:{onEventRefresh:function(){this.syncHeaders()}}});Ext.define('Ext.calendar.view.Day',{extend:'Ext.calendar.view.Days',xtype:'calendar-dayview',config:{compactOptions:{displayOverlap:!0},visibleDays:1},privates:{getMoveInterval:function(){return {unit:Ext.Date.DAY,amount:1}}}});Ext.define('Ext.calendar.panel.Day',{extend:'Ext.calendar.panel.Days',xtype:'calendar-day',requires:['Ext.calendar.view.Day'],config:{view:{xtype:'calendar-dayview'}}});Ext.define('Ext.calendar.view.WeeksRenderer',{days:null,index:null,maxEvents:null,overflow:!0,start:null,view:null,constructor:function(d){var a=this,b=Ext.Date,c,e;Ext.apply(a,d);c=a.start;a.end=e=b.add(c,b.DAY,a.days,!0);a.utcStart=this.view.utcTimezoneOffset(c);a.utcEnd=b.add(a.utcStart,b.DAY,a.days,!0);a.hasMaxEvents=a.maxEvents!==null;a.rows=[];a.events=[];a.seen={};a.overflows=[]},addIf:function(b){var a=this,c,d;if(b.getAllDay()){c=a.utcStart;d=a.utcEnd}else {c=a.start;d=a.end}if(b.occursInRange(c,d)){a.events.push(b)}},calculate:function(){var b=this,j=Ext.Date,L=b.view,B=b.seen,F=b.events,M=F.length,A=b.days,K=b.end,J=b.utcEnd,z=j.clone(b.start),v=j.clone(b.utcStart),m=b.maxEvents,I=b.hasMaxEvents,t=b.overflows,D=b.overflow?1:0,q=[],e,a,c,f,g,y,C,h,u,n,l,s,p,w,d,G,x,E,o,i,k,H,r;for(e=0;e<A;++e){C=j.add(z,j.DAY,1,!0);y=j.add(v,j.DAY,1,!0);c=[];for(a=0;a<M;++a){f=F[a];h=f.id;w=f.getAllDay();if(w){l=v;s=y;p=J}else {l=z;s=C;p=K}if(f.occursInRange(l,s)){x=f.isSpan();if(!B[h]){n=1;if(x){u=f.getEndDate();if(u>p){n=A-e}else {n=L.getDaysSpanned(l,u,w)}}B[h]=n;c.push({event:f,id:h})}else {if(x){c.push({isPlaceholder:!0,event:f,id:h})}}}}g=c.length;c.sort(b.sortEvents);if(I){k={};t[e]=i=[];i.$map=k;if(e>0){H=t[e-1].$map;for(a=0;a<g;++a){d=c[a];h=d.id;if(H[h]){i.push(d.event);k[h]=!0;c.splice(a,1);o=!0;--a;--g}}}if(g>0){if(g>m){G=Math.max(0,m-D);r=Ext.Array.splice(c,G);for(a=0,E=r.length;a<E;++a){d=r[a];i.push(d.event);k[d.id]=!0}o=!0}else {if(D>0&&i.length&&g===m){d=c.pop();i.push(d.event);k[d.id]=!0}}}}q.push(c);z=C;v=y}if(o&&m>0){b.calculateOverflows(q,t)}for(e=0;e<A;++e){c=q[e];g=c.length;for(a=0;a<g;++a){d=c[a];if(!d.isPlaceholder){f=d.event;b.addToRow(f,e,B[f.id])}}}},compress:function(e){var h=this.rows[e],c=[],f=this.days,a=0,d=0,g,b;while(d<f){g=1;b=h[d];if(b.event){if(a>0){c.push({isEmpty:!0,len:a});a=0}c.push(b);d+=b.len}else {++a;++d}}if(a>0){c.push({isEmpty:!0,len:a})}return c},hasEvents:function(){return this.events.length>0},privates:{addToRow:function(j,e,k){var i=this,d=i.rows,l=d.length,f=k+e,a,b,c,h,g;for(b=0;b<l;++b){h=d[b];for(c=e;c<f;++c){if(h[c]){break}}if(c===f){a=h;g=b;break}}if(!a){a=i.makeRow();d.push(a);g=d.length-1}i.occupy(j,a,g,e,f-1)},calculateOverflows:function(g,d){var i=this.days,h=this.maxEvents,a,c,b,e,f;for(a=i-2;a>=0;--a){c=g[a];b=c.length;if(b>0&&d[a].length===0&&b===h){e=c[b-1];f=e.id;if(d[a+1].$map[f]){d[a].unshift(e.event);d[a].$map[f]=!0;c.length=b-1}}}},makeRow:function(){var b=[],c=this.days,a;for(a=0;a<c;++a){b[a]=0}return b},occupy:function(e,g,d,b,c){var f=c-b+1,a;for(a=b;a<=c;++a){g[a]=a===b?{event:e,len:f,start:b,weekIdx:this.index,localIdx:d}:!0}},sortEvents:function(a,b){a=a.event;b=b.event;return +b.isSpan()-+a.isSpan()||Ext.calendar.model.Event.sort(a,b)}}});Ext.define('Ext.calendar.view.Weeks',{extend:'Ext.calendar.view.Base',xtype:'calendar-weeksview',requires:['Ext.calendar.view.WeeksRenderer'],uses:['Ext.calendar.dd.WeeksSource','Ext.calendar.dd.WeeksTarget'],isWeeksView:!0,baseCls:Ext.baseCSSPrefix+'calendar-weeks',config:{addOnSelect:!0,allowSelection:!0,compactOptions:{overflowText:'+{0}',showOverflow:'top'},dayFormat:'j',draggable:!0,droppable:!0,firstDayOfWeek:undefined,overflowText:'+{0} more',showOverflow:'bottom',value:undefined,visibleDays:7,visibleWeeks:2,weekendDays:undefined},constructor:function(b){var a=this;a.callParent([b]);a.el.on('tap','handleEventTap',a,{delegate:'.'+a.$eventCls});a.cellTable.on('click','onOverflowClick',a,{delegate:'.'+a.$overflowCls});a.recalculate();a.refreshHeaders()},getDisplayRange:function(){var a=this,b;if(a.isConfiguring){a.recalculate()}b=a.dateInfo[a.displayRangeProp];return new Ext.calendar.date.Range(a.utcToLocal(b.start),a.utcToLocal(b.end))},getVisibleRange:function(){var b=Ext.Date,a;if(this.isConfiguring){this.recalculate()}a=this.dateInfo.visible;return new Ext.calendar.date.Range(b.clone(a.start),b.clone(a.end))},updateAllowSelection:function(b){var a=this;a.selectionListeners=Ext.destroy(a.selectionListeners);if(b){a.el.on({destroyable:!0,scope:a,touchstart:'onTouchStart',touchmove:'onTouchMove',touchend:'onTouchEnd'})}},updateDayFormat:function(a){if(!this.isConfiguring){this.refresh()}},updateDaysInWeek:function(){this.refresh()},applyDraggable:function(a){if(a){a=new Ext.calendar.dd.WeeksSource(a)}return a},updateDraggable:function(b,a){if(a){a.destroy()}if(b){b.setView(this)}},applyDroppable:function(a){if(a){a=new Ext.calendar.dd.WeeksTarget()}return a},updateDroppable:function(b,a){if(a){a.destroy()}if(b){b.setView(this)}},applyFirstDayOfWeek:function(a){if(typeof a!=='number'){a=Ext.Date.firstDayOfWeek}return a},updateFirstDayOfWeek:function(b){var a=this;if(!a.isConfiguring){a.recalculate();a.refreshHeaders();a.refresh()}},updateShowOverflow:function(b,a){var c=Ext.baseCSSPrefix+'calendar-weeks-with-overflow-',d=this.element;if(a){d.removeCls(c+a)}if(b){d.addCls(c+b)}if(!this.isConfiguring){this.refresh()}},updateTimezoneOffset:function(){if(!this.isConfiguring){this.recalculate()}},updateValue:function(c,b){var a=this;if(!a.isConfiguring){a.suspendEventRefresh();a.recalculate();a.resumeEventRefresh();a.refreshHeaders();a.refresh()}a.callParent([c,b])},updateVisibleDays:function(){var a=this;if(!a.isConfiguring){a.recalculate();a.refreshHeaders();a.refresh()}},updateVisibleWeeks:function(c){var a=this,b=a.cellTable;a.suspendEventRefresh();a.recalculate();a.resumeEventRefresh();b.removeChild(b.dom.firstChild);b.createChild({tag:'tbody',children:a.generateCells(a.dateInfo.requiredWeeks,!0)});a.cells=a.queryCells();if(!a.isConfiguring){a.refresh()}},applyWeekendDays:function(a){return a||Ext.Date.weekendDays},updateWeekendDays:function(a){this.weekendDayMap=Ext.Array.toMap(a);this.refresh()},getElementConfig:function(){var b=this,a=b.callParent();a.children=[{tag:'table',reference:'cellTable',cls:b.$tableCls+' '+Ext.baseCSSPrefix+'calendar-weeks-week-rows',children:[{tag:'tbody'}]}];return a},doDestroy:function(){var a=this;a.setAllowSelection(!1);a.setDraggable(null);a.setDroppable(null);a.callParent()},privates:{displayRangeProp:'visible',domFormat:'Y-m-d',eventGutter:5,maxDayMonth:new Date(2000,0,1),sundayDay:new Date(2000,9,1),startMarginName:'left',trackRanges:!1,$rowCls:Ext.baseCSSPrefix+'calendar-weeks-row',$cellCls:Ext.baseCSSPrefix+'calendar-weeks-cell',$weekendCls:Ext.baseCSSPrefix+'calendar-weeks-weekend-cell',$outsideCls:Ext.baseCSSPrefix+'calendar-weeks-outside-cell',$pastCls:Ext.baseCSSPrefix+'calendar-weeks-past-cell',$futureCls:Ext.baseCSSPrefix+'calendar-weeks-future-cell',$todayCls:Ext.baseCSSPrefix+'calendar-weeks-today-cell',$selectionCls:Ext.baseCSSPrefix+'calendar-weeks-selection',$dayTextCls:Ext.baseCSSPrefix+'calendar-weeks-day-text',$hiddenCellCls:Ext.baseCSSPrefix+'calendar-weeks-hidden-cell',$cellInnerCls:Ext.baseCSSPrefix+'calendar-weeks-cell-inner',$overflowCls:Ext.baseCSSPrefix+'calendar-weeks-overflow',$cellOverflowCls:Ext.baseCSSPrefix+'calendar-weeks-overflow-cell',$overflowPopupCls:Ext.baseCSSPrefix+'calendar-weeks-overflow-popup',clearSelected:function(){var b=this.cells,c=b.length,a;for(a=0;a<c;++a){Ext.fly(b[a]).removeCls(this.$selectionCls)}},constructEvents:function(){var a=this,h=Ext.Date,n=Ext.Date.DAYS_IN_WEEK,i=a.getEventSource().getRange(),q=i.length,m=a.getVisibleDays(),k=a.dateInfo.requiredWeeks,e=h.clone(a.dateInfo.visible.start),l=a.getEventStyle().fullHeight,o=Math.floor(a.getDaySizes().heightForEvents/l),p=a.getShowOverflow()==='bottom',j=[],c,d,b,g,f;a.weeks=j;g=document.createDocumentFragment();for(c=0;c<k;++c){b=new Ext.calendar.view.WeeksRenderer({view:a,start:e,days:m,index:c,overflow:p,maxEvents:o});for(d=0;d<q;++d){f=i[d];if(!a.isEventHidden(f)){b.addIf(f)}}if(b.hasEvents()){b.calculate()}a.processWeek(b,g);j.push(b);e=h.add(e,h.DAY,n,!0)}a.element.appendChild(g)},createEvent:function(a,b,c){var d=a?a.isSpan():!0;b=Ext.apply({mode:d?'weekspan':'weekinline'},b);return this.callParent([a,b,c])},doRecalculate:function(a){var c=this,b=Ext.Date,d=b.DAYS_IN_WEEK,g=c.getVisibleWeeks(),f=Ext.calendar.date.Range,i,h,e;a=a||c.getValue();a=b.clearTime(a,!0);h=(a.getDay()+d-c.getFirstDayOfWeek())%d;i=c.toUtcOffset(a);a=b.subtract(i,b.DAY,h,!0);e=b.add(a,b.DAY,g*d-(d-c.getVisibleDays()),!0);return {full:new f(a,e),visible:new f(a,e),active:new f(a,b.subtract(e,b.DAY,1,!0)),requiredWeeks:g}},doRefresh:function(){var a=this,d=Ext.Date,g=a.dateInfo,q=a.getDayFormat(),n=a.weekendDayMap,i=d.clearTime(Ext.calendar.date.Util.getLocalNow()),b=a.utcToLocal(g.visible.start),c=[],j=a.trackRanges,o=a.getVisibleDays(),p=Ext.Date.DAYS_IN_WEEK,t=i.getFullYear(),s=i.getMonth(),r=i.getDate(),h,m,e,f,k,l;if(j){k=a.utcToLocal(g.month.start);l=a.utcToLocal(g.month.end)}h=a.cells;for(e=0,m=h.length;e<m;++e){f=h[e];c.length=0;c.push(a.$cellCls);if(n[b.getDay()]){c.push(a.$weekendCls)}if(j){if(b<k){c.push(a.$pastCls,a.$outsideCls)}else {if(b>l){c.push(a.$futureCls,a.$outsideCls)}}}if(b.getFullYear()===t&&b.getMonth()===s&&b.getDate()===r){c.push(a.$todayCls)}if(e%p>=o){c.push(a.$hiddenCellCls)}f.className=c.join(' ');f.setAttribute('data-date',d.format(b,a.domFormat));f.firstChild.firstChild.innerHTML=d.format(b,q);b=d.add(b,d.DAY,1,!0)}a.refreshEvents()},doRefreshEvents:function(){var a=this,b=a.getEventSource();a.clearEvents();a.hideOverflowPopup();if(b&&b.getCount()){a.constructEvents()}},findIndex:function(c,b){var a=0,d=c.length;while(a<d){b-=c[a];if(b<=0){break}++a}return a},generateCells:function(e,i){var a=this,h=Ext.Date.DAYS_IN_WEEK,g=[],b,c,d,f;if(i){f={height:100/e+'%'}}for(b=0;b<e;++b){d=[];for(c=0;c<h;++c){d.push({tag:'td','data-index':c,cls:a.$cellCls,children:[{cls:a.$cellInnerCls,children:[{tag:'span',cls:a.$dayTextCls},{cls:a.$overflowCls}]}]})}g.push({tag:'tr',cls:a.$rowCls,'data-week':b,children:d,style:f})}return g},getCell:function(a){var e=null,d=this.cells,f=d.length,b,c;if(Ext.isDate(a)){a=Ext.Date.format(a,this.domFormat)}for(b=0;b<f;++b){c=d[b];if(c.getAttribute('data-date')===a){e=c;break}}return e},getCellByPosition:function(f,g){var a=this,c,b,d,e;c=a.getDaySizes();b=a.element.getXY();d=a.findIndex(c.widths,f-b[0]);e=a.findIndex(c.heights,g-b[1]);return a.cells[e*Ext.Date.DAYS_IN_WEEK+d]},getCellFromEvent:function(c,d){var a,b;a=c.getTarget('.'+this.$cellCls,this.element);if(!a&&d){b=c.getXY();a=this.getCellByPosition(b[0],b[1])}return a},getDateFromCell:function(a){return Ext.Date.parse(a.getAttribute('data-date'),this.domFormat)},getDaySizes:function(){var a=this,j=a.daySizes,k=a.cells,l=a.getVisibleDays(),f=Number.MAX_VALUE,i,e,b,h,g,d,c;if(!a.daySizes){i=k[0];b=Ext.fly(i.firstChild);e=b.getPadding('tb')+Ext.fly(i.firstChild.firstChild).getHeight();h=[];g=[];for(d=0;d<l;++d){b=Ext.fly(k[d]);h.push(b.getWidth());c=b.getHeight();g.push(c);if(c<f){f=c}}a.daySizes=j={widths:h,heights:g,headerHeight:e,heightForEvents:Math.max(0,f-e-a.eventGutter)}}return j},getEventStyle:function(){var c=this,d=c.eventStyle,e,b,a,f;if(!d){e=c.createEvent(null,null,!0);b=e.element;b.dom.style.visibility='hidden';c.element.appendChild(b);f=b.getHeight();a=b.getMargin();a.height=a.top+a.bottom;a.width=a.left+a.right;c.eventStyle=d={margin:a,height:f,fullHeight:f+a.height};e.destroy()}return d},getEventWidget:function(a){var b=this.$eventCls,c;if(a.isEvent){a=a.target}if(!Ext.fly(a).hasCls(b)){a=Ext.fly(a).up('.'+b,this.element,!0)}c=a.getAttribute('data-componentid');return this.eventMap[c]},getMoveBaseValue:function(){return this.utcToLocal(this.dateInfo.visible.start)},getMoveInterval:function(){var a=Ext.Date;return {unit:a.DAY,amount:a.DAYS_IN_WEEK*this.getVisibleWeeks()}},handleEventTap:function(b){var a=this.getEvent(b);if(a){this.hideOverflowPopup();this.onEventTap(a)}},handleResize:function(){var a=this;a.callParent();a.daySizes=null;a.hideOverflowPopup();a.refreshEvents()},hideOverflowPopup:Ext.privateFn,onOverflowClick:function(f){var b=this,a=b.getCellFromEvent(f),d=b.getDateFromCell(a),e=parseInt(a.parentNode.getAttribute('data-week'),10),c=parseInt(a.getAttribute('data-index'),10);b.showOverflowPopup(b.weeks[e].overflows[c],d,a)},onSourceAttach:function(){this.recalculate()},onTouchEnd:function(){var a=this,d=Ext.Date,e=a.cells,b,c,g,f;if(a.isSelecting){b=a.selectedStartIndex;c=a.selectedEndIndex;if(b===c){b=c=a.getDateFromCell(e[b]);a.fireEvent('select',a,{date:b})}else {if(b>c){g=c;c=b;b=g}b=a.getDateFromCell(e[b]);c=a.getDateFromCell(e[c]);a.fireEvent('selectrange',a,{range:new Ext.calendar.date.Range(b,c)})}if(a.getAddOnSelect()){if(a.hasEditableCalendars()&&a.getAddForm()){f=a.createModel({allDay:!0,startDate:d.localToUtc(b),endDate:d.add(d.localToUtc(c),d.DAY,1,!0)});a.showAddForm(f,{scope:a,onSave:a.clearSelected,onCancel:a.clearSelected})}else {a.clearSelected()}}a.isSelecting=!1}},onTouchMove:function(j){var b=this,a=b.selectedStartIndex,f=b.cells,i=f.length,e,d,c,g,h;if(b.isSelecting){g=b.getCellFromEvent(j,!0);d=Ext.Array.indexOf(f,g);if(d>a){e=d}else {if(d<a){e=a;a=d;h=!0}else {e=a}}b.selectedEndIndex=h?a:e;for(c=0;c<i;++c){Ext.fly(f[c]).toggleCls(b.$selectionCls,c>=a&&c<=e)}}},onTouchStart:function(c,e){var a=this,d=a.element,b;if(c.pointerType==='touch'||c.getTarget('.'+a.$overflowCls,d)||c.getTarget('.'+a.$overflowPopupCls,d)){return}b=a.getCellFromEvent(c);if(b){a.isSelecting=!0;a.selectedStartIndex=a.selectedEndIndex=Ext.Array.indexOf(a.cells,b);Ext.fly(b).addCls(a.$selectionCls)}},positionEvent:function(e,b){var a=this,c=a.getDaySizes(),g=a.getEventStyle(),d=g.margin,h=c.widths,i=b.start,j=b.localIdx,k=b.weekIdx,f;f=c.headerHeight+g.height*j+(j+1)*d.height;e.setTop(a.positionSum(0,k,c.heights)+f);e.setLeft(a.positionSum(0,i,h)+d[a.startMarginName]);e.setWidth(a.positionSum(i,b.len,h)-d.width)},positionSum:function(b,f,d){var c=0,e=b+f,a;for(a=b;a<e;++a){c+=d[a]}return c},processWeek:function(c,u){var b=this,n=c.rows,t=c.days,k=c.overflows,r=c.index*Ext.Date.DAYS_IN_WEEK,q=b.getShowOverflow(),s=b.cells,j=b.$cellOverflowCls,p=b.getOverflowText(),d,i,a,l,h,f,m,g,e,o;if(n){for(a=0,o=n.length;a<o;++a){i=c.compress(a);for(h=0,l=i.length;h<l;++h){f=i[h];if(!f.isEmpty){m=b.createEvent(f.event);g=m.element;g.dom.style.margin='0';u.appendChild(g.dom);b.positionEvent(g,f)}}}}for(a=0;a<t;++a){e=s[r+a];d=k&&k[a];if(d&&d.length&&q){Ext.fly(e).addCls(j);e.firstChild.lastChild.innerHTML=Ext.String.format(p,d.length)}else {Ext.fly(e).removeCls(j)}}},queryCells:function(){return this.element.query('.'+this.$cellCls)},recalculate:function(){var a=this.doRecalculate();this.dateInfo=a;this.setSourceRange(a.visible)},refreshHeaders:function(){var b=this,a=b.getHeader(),c=b.dateInfo;if(a){a.setVisibleDays(this.getVisibleDays());if(c){a.setValue(b.utcToLocal(c.visible.start))}}},selectRange:function(a,b){var c=this,i=Ext.Date,d=c.dateInfo.active,h=c.cells,j=h.length,g=!1,f,e;if(a<d.start){a=d.start}if(b>d.end){b=d.end}a=c.getCell(i.clearTime(a,!0));b=c.getCell(i.clearTime(b,!0));if(a&&b){for(f=0;f<j;++f){e=h[f];if(e===a){g=!0}Ext.fly(e).toggleCls(c.$selectionCls,g);if(e===b){g=!1}}}},showOverflowPopup:Ext.privateFn}});Ext.define('Ext.overrides.calendar.view.Weeks',{override:'Ext.calendar.view.Weeks',requires:['Ext.calendar.form.Edit','Ext.calendar.form.Add'],doDestroy:function(){this.tip=Ext.destroy(this.tip);this.callParent()},privates:{doRefresh:function(){this.callParent();this.updateLayout()},hideOverflowPopup:function(){var a=this.tip;if(a){a.hide();a.removeAll()}},showOverflowPopup:function(c,e,d){var a=this,b=a.tip;if(!b){a.tip=b=new Ext.tip.ToolTip({ui:'calendar-overflow',anchor:!0,renderTo:document.body,hidden:!0,autoHide:!1,cls:a.$overflowPopupCls,minWidth:200,defaultAlign:'tc-bc?'});a.tip.el.on('tap','handleEventTap',a,{delegate:'.'+a.$eventCls})}b.removeAll();c=a.createEvents(c,{cls:a.$staticEventCls});b.add(c);b.el.dom.setAttribute('data-date',Ext.Date.format(e,a.domFormat));b.showBy(d)}}});Ext.define('Ext.calendar.panel.Weeks',{extend:'Ext.calendar.panel.Base',xtype:'calendar-weeks',requires:['Ext.calendar.header.Weeks','Ext.calendar.view.Weeks'],config:{dayHeader:{xtype:'calendar-weeksheader'},eventRelayers:{view:{beforeeventdragstart:!0,validateeventdrop:!0,eventdrop:!0}},view:{xtype:'calendar-weeksview'}},configExtractor:{dayHeader:{dayHeaderFormat:'format'},view:{addOnSelect:!0,allowSelection:!0,dayFormat:!0,draggable:!0,droppable:!0,firstDayOfWeek:!0,overflowText:!0,showOverflow:!0,visibleDays:!0,visibleWeeks:!0,weekendDays:!0}}});Ext.define('Ext.calendar.view.Month',{extend:'Ext.calendar.view.Weeks',xtype:'calendar-monthview',config:{value:undefined,visibleWeeks:6},nextMonth:function(a){this.navigate(this.getNavigateValue(a),Ext.Date.MONTH)},nextYear:function(a){this.navigate(this.getNavigateValue(a),Ext.Date.YEAR)},previousMonth:function(a){this.navigate(-this.getNavigateValue(a),Ext.Date.MONTH)},previousYear:function(a){this.navigate(-this.getNavigateValue(a),Ext.Date.YEAR)},privates:{displayRangeProp:'month',maxWeeks:6,$rowClasses:[Ext.baseCSSPrefix+'calendar-month-4weeks',Ext.baseCSSPrefix+'calendar-month-5weeks',Ext.baseCSSPrefix+'calendar-month-6weeks'],trackRanges:!0,doRecalculate:function(a){var c=this,b=Ext.Date,f=b.DAYS_IN_WEEK,n=c.getFirstDayOfWeek(),h=c.maxWeeks,o=c.getVisibleWeeks(),i=c.getVisibleDays(),g=Ext.calendar.date.Range,k,e,j,m,l,d;a=b.getFirstDateOfMonth(a||c.getValue());d=(a.getDay()+f-n)%f;j=c.toUtcOffset(a);m=b.getLastDateOfMonth(a);l=c.toUtcOffset(m);if(o===null){if(d>=i){d=i-d}k=d+b.getDaysInMonth(a);h=Math.ceil(k/f)}e=f*h-(f-i);a=b.subtract(j,b.DAY,d,!0);e=b.add(a,b.DAY,e,!0);return {full:new g(a,e),visible:new g(a,e),active:new g(a,b.subtract(e,b.DAY,1,!0)),month:new g(j,l),requiredWeeks:h}},doRefresh:function(){var a=this,b=a.$rowClasses,c=a.dateInfo.requiredWeeks;a.element.replaceCls(b,b[c-1-b.length]);a.callParent()},getMoveBaseValue:function(){return this.utcToLocal(this.dateInfo.month.start)},getMoveInterval:function(){return {unit:Ext.Date.MONTH,amount:1}},generateCells:function(){return this.callParent([this.maxWeeks,!1])},getNavigateValue:function(a){return a||a===0?a:1}}});Ext.define('Ext.calendar.panel.Month',{extend:'Ext.calendar.panel.Weeks',xtype:'calendar-month',requires:['Ext.calendar.view.Month'],config:{view:{xtype:'calendar-monthview'}},autoSize:!1,nextMonth:function(a){this.getView().nextMonth(a)},nextYear:function(a){this.getView().nextYear(yers)},previousMonth:function(a){this.getView().previousMonth(a)},previousYear:function(a){this.getView().previousYears(a)}});Ext.define('Ext.calendar.panel.AbstractPanel',{extend:'Ext.panel.Panel',requires:['Ext.layout.container.Border','Ext.button.Segmented','Ext.toolbar.Toolbar'],layout:'border',config:{createButton:{ui:'default-small'},sideBar:{region:'west',collapsible:!0}},items:[{xtype:'panel',reference:'mainContainer',region:'center',layout:'fit'}],initComponent:function(){var a=this,b;a.callParent();b=a.lookup('mainContainer');a.addSideBar({collapsed:a.getCompact()});a.addTitleBar();b.add(a.createView());a.refreshCalTitle()},onRender:function(b,a){this.callParent([b,a]);this.body.unselectable()},updateCompact:function(a){if(!this.isConfiguring){this.reconfigureItems()}},updateCreateButtonPosition:function(){var a=this,b=a.sheet,c;if(!a.isConfiguring){c=b&&b.isVisible();a.reconfigureItems();if(c){a.showSheet()}}},updateSwitcherPosition:function(){var a=this,b=a.sheet,c;if(!a.isConfiguring){c=b&&b.isVisible();a.reconfigureItems();if(c){a.showSheet()}}},privates:{addSideBar:function(){var a=this.createSideBar();if(a){this.add(a)}},addTitleBar:function(){var a=this.createTitleBar();if(a){this.lookup('mainContainer').addDocked(a)}},createSideBar:function(c){var a=this,b=[];if(a.getCreateButtonPosition()==='sideBar'){b.push({xtype:'container',margin:'0 0 10 0',layout:{type:'hbox',pack:'center'},items:a.createCreateButton()})}b.push(a.createCalendarList());if(a.getSwitcherPosition()==='sideBar'){b.push(a.createSwitcher({vertical:!0}))}c=Ext.merge({reference:'sideBar',layout:{type:'vbox',align:'stretch'}},c);return this.createContainerWithChildren(c,this.getSideBar(),b)},createTitleBar:function(){var a=this,b=[];if(a.getCreateButtonPosition()==='titleBar'){b.push(a.createCreateButton({margin:'0 10 0 0'}))}b.push(a.createTodayButton(),{xtype:'segmentedbutton',allowToggle:!1,items:[a.createPreviousButton(),a.createNextButton()]},a.createDateTitle());if(a.getSwitcherPosition()==='titleBar'){b.push({xtype:'component',flex:1},a.createSwitcher())}return this.createContainerWithChildren({reference:'titleBar'},this.getTitleBar(),b)},onSwitcherChange:function(b,a){this.doSetView(a,!0)},reconfigureItems:function(){var a=this;Ext.suspendLayouts();Ext.destroy(a.lookup('titleBar'),a.lookup('sideBar'));a.addTitleBar();a.addSideBar({collapsed:a.getCompact()});a.refreshCalTitle();Ext.resumeLayouts(!0)},setSwitcherValue:function(b){var a=this.lookup('switcher');if(a){a.setValue(b)}else {this.setView(b,!0)}}}});Ext.define('Ext.calendar.view.Week',{extend:'Ext.calendar.view.Days',xtype:'calendar-weekview',config:{firstDayOfWeek:undefined,visibleDays:7},applyFirstDayOfWeek:function(a){if(typeof a!=='number'){a=Ext.Date.firstDayOfWeek}return a},updateFirstDayOfWeek:function(){var a=this;if(!a.isConfiguring){a.recalculate();a.refreshHeaders();a.checkNowMarker()}},privates:{doRecalculate:function(a){var c=this,b=Ext.Date,e=Ext.calendar.date.Range,g=b.DAYS_IN_WEEK,f,h,d;a=a||c.getValue();a=b.clearTime(a,!0);f=(a.getDay()+g-c.getFirstDayOfWeek())%g;a=c.toUtcOffset(a);a=b.subtract(a,b.DAY,f,!0);d=b.add(a,b.DAY,c.getVisibleDays(),!0);h=b.subtract(d,b.DAY,1,!0);return {full:new e(a,d),active:new e(a,h),visible:new e(b.add(a,b.HOUR,c.getStartTime(),!0),b.subtract(d,b.HOUR,24-c.getEndTime(),!0))}},getMoveBaseValue:function(){return this.utcToLocal(this.dateInfo.full.start)},getMoveInterval:function(){var a=Ext.Date;return {unit:a.DAY,amount:a.DAYS_IN_WEEK}}}});Ext.define('Ext.calendar.panel.Week',{extend:'Ext.calendar.panel.Days',xtype:'calendar-week',requires:['Ext.calendar.view.Week'],config:{view:{xtype:'calendar-weekview'}},configExtractor:{view:{firstDayOfWeek:!0}}});Ext.define('Ext.calendar.view.Multi',{extend:'Ext.container.Container',xtype:'calendar-multiview',requires:['Ext.calendar.date.Util'],layout:'fit',platformConfig:{'!desktop':{compact:!0}},config:{compact:!1,compactOptions:null,store:null,timezoneOffset:undefined,value:undefined,views:null},defaultView:null,constructor:function(b){this.callParent([b]);var a=this.defaultView;if(a){this.setView(a)}},moveNext:function(){this.setValue(this.activeView.calculateMoveNext())},movePrevious:function(){this.setValue(this.activeView.calculateMovePrevious())},navigate:function(a,c){var b=Ext.Date;if(a!==0){this.setValue(b.add(this.getValue(),c||b.DAY,a,!0))}},setView:function(c){var a=this,b=a.activeView,d;if(b&&b.$key===c){return}Ext.suspendLayouts();if(b){a.remove(b)}d=a.getViews()[c];a.activeView=a.add(a.createView(d,c));a.activeView.on('valuechange','onValueChange',a);a.recalculate(a.getValue());Ext.resumeLayouts(!0)},updateCompact:function(a){this.setViewCfg('setCompact',a)},applyStore:function(a){if(a){a=Ext.StoreManager.lookup(a,'calendar-calendars')}return a},updateStore:function(b){var a=this;a.setViewCfg('setStore',b);if(!a.isConfiguring){a.recalculate(a.getValue())}},applyTimezoneOffset:function(a){this.autoOffset=!1;if(a===undefined){a=Ext.calendar.date.Util.getDefaultTimezoneOffset();this.autoOffset=!0}return a},updateTimezoneOffset:function(a){this.setViewCfg('setTimezoneOffset',a)},applyValue:function(a,b){a=Ext.Date.clearTime(a||Ext.calendar.date.Util.getLocalNow(),!0);if(b&&b.getTime()===a.getTime()){a=undefined}return a},updateValue:function(a){if(!this.isConfiguring){this.recalculate(a)}},showAddForm:function(b,a){return this.activeView.showAddForm(b,a)},showEditForm:function(b,a){return this.activeView.showEditForm(b,a)},privates:{createView:function(b,c){var a=this;return Ext.apply({$key:c,controlStoreRange:!1,compact:a.getCompact(),store:a.getStore(),timezoneOffset:a.autoOffset?undefined:a.getTimezoneOffset(),value:a.getValue()},b)},getActiveKey:function(){var a=this.activeView;return a?a.$key:''},onValueChange:function(b,a){this.setValue(a.value);this.fireEvent('valuechange',this,a)},recalculate:function(e){var a=this.activeView,d=this.getStore(),c,b;if(a&&d){b=d.getEventSource();c=Ext.calendar.date.Util.expandRange(a.getView().doRecalculate(e).full);b.setRange(c);a.setValue(e)}},setViewCfg:function(b,c){if(!this.isConfiguring){var a=this.activeView;if(a){a[b](c)}}}}});Ext.define('Ext.calendar.panel.Panel',{extend:'Ext.calendar.panel.AbstractPanel',xtype:'calendar',mixins:['Ext.mixin.ConfigState'],alternateStateConfig:'compactOptions',requires:['Ext.calendar.panel.Day','Ext.calendar.panel.Week','Ext.calendar.panel.Month','Ext.calendar.List','Ext.calendar.view.Multi','Ext.calendar.date.Util'],referenceHolder:!0,platformConfig:{'!desktop':{compact:!0}},config:{calendarList:{xtype:'calendar-list',reference:'list',flex:1},compact:!1,compactOptions:{},createButton:{xtype:'button',cls:Ext.baseCSSPrefix+'calendar-panel-create-button',text:'Create'},createButtonPosition:'sideBar',dateTitle:{xtype:'component',reference:'calTitle',cls:Ext.baseCSSPrefix+'calendar-panel-title',margin:'0 0 0 10'},nextButton:{xtype:'button',text:'>'},previousButton:{xtype:'button',text:'<'},sideBar:{xtype:'panel',cls:Ext.baseCSSPrefix+'calendar-sidebar'},store:null,switcher:{xtype:'segmentedbutton',reference:'switcher',cls:Ext.baseCSSPrefix+'calendar-panel-switcher',allowMultiple:!1},switcherPosition:'titleBar',timezoneOffset:undefined,titleBar:{xtype:'toolbar'},todayButton:{xtype:'button',text:'Today',margin:'0 10 0 0'},value:undefined,views:{day:{xtype:'calendar-day',titleTpl:'{start:date("l F d, Y")}',controlStoreRange:!1,label:'Day',weight:10,dayHeader:null},week:{xtype:'calendar-week',dayHeaderFormat:'D d',controlStoreRange:!1,titleTpl:'{start:date("j M")} - {end:date("j M Y")}',label:'Week',weight:20},month:{xtype:'calendar-month',titleTpl:'{start:date("F Y")}',label:'Month',weight:30}}},defaultView:'month',cls:Ext.baseCSSPrefix+'calendar-panel',moveNext:function(){this.getView().moveNext()},movePrevious:function(){this.getView().movePrevious()},navigate:function(b,a){this.getView().navigate(b,a)},setView:function(a){this.doSetView(a)},updateCompact:function(a,c){var b=this;b.toggleCls(Ext.baseCSSPrefix+'compact',a);b.toggleConfigState(a);b.callParent([a,c]);b.setViewCfg('setCompact',a)},updateCompactOptions:function(){if(!this.isConfiguring&&this.getCompact()){this.toggleConfigState(!0)}},applyStore:function(a){if(a){a=Ext.StoreManager.lookup(a,'calendar-calendars')}return a},updateStore:function(a){var b=this.lookup('list');this.setViewCfg('setStore',a);if(b){b.setStore(a)}},applyTimezoneOffset:function(a){this.autoOffset=!1;if(a===undefined){a=Ext.calendar.date.Util.getDefaultTimezoneOffset();this.autoOffset=!0}return a},updateTimezoneOffset:function(a){this.setViewCfg('setTimezoneOffset',a)},applyValue:function(a,b){a=Ext.Date.clearTime(a||Ext.calendar.date.Util.getLocalNow(),!0);if(b&&b.getTime()===a.getTime()){a=undefined}return a},updateValue:function(a){this.setViewCfg('setValue',a);this.refreshCalTitle()},getValue:function(){var a=this.getView();return a?a.getValue():this.callParent()},getView:function(){return this.lookup('view')},privates:{weightStart:0,weightIncrement:10,createCalendarList:function(a){return Ext.apply({store:this.getStore()},this.getCalendarList())},createCreateButton:function(a){a=a||{};a=Ext.apply(a,this.getCreateButton());return Ext.apply({handler:'onCreateTap',scope:this},a)},createContainerWithChildren:function(i,b,a){b=Ext.apply({},b);var f=this,c=b.items,g=f.weightStart,j=f.weightIncrement,h,d,e;if(c){if(!Ext.isArray(c)){c=[c]}a=Ext.Array.clone(a);for(d=0,h=a.length;d<h;++d){e=a[d];if(e.weight==null){a[d]=Ext.apply({weight:g},e)}g+=j}a=a.concat(c);Ext.Array.sort(a,f.weightSorter);delete b.items}b.items=a;return Ext.apply(b,i)},createDateTitle:function(a){a=a||{};return Ext.apply(a,this.getDateTitle())},createNextButton:function(){return Ext.apply({handler:'onNextTap',scope:this},this.getNextButton())},createPreviousButton:function(){return Ext.apply({handler:'onPrevTap',scope:this},this.getPreviousButton())},createSwitcher:function(b){var a=this,c=a.getView();b=Ext.apply({value:c&&c.getActiveKey()||a.defaultView,listeners:{scope:a,change:'onSwitcherChange'},items:a.getSwitcherItems()},b);return Ext.apply(b,a.getSwitcher())},createTodayButton:function(){return Ext.apply({handler:'onTodayTap',scope:this},this.getTodayButton())},createView:function(){var a=this;return {xtype:'calendar-multiview',reference:'view',compact:a.getCompact(),defaultView:a.defaultView,store:a.getStore(),timezoneOffset:a.autoOffset?undefined:a.getTimezoneOffset(),value:a.getValue(),views:a.getViews(),listeners:{scope:a,valuechange:'onValueChange'}}},doSetView:function(a,b){if(!b){this.setSwitcherValue(a);return}this.getView().setView(a);this.refreshCalTitle()},getSwitcherItems:function(){var d=this.getViews(),b=[],c,a;for(c in d){a=d[c];if(a){b.push({text:a.label,value:c,weight:a.weight})}}b.sort(this.weightSorter);return b},onCreateTap:function(){this.getView().showAddForm()},onNextTap:function(){this.moveNext()},onPrevTap:function(){this.movePrevious()},onValueChange:function(b,a){this.setValue(a.value)},onTodayTap:function(){this.setValue(new Date())},refreshCalTitle:function(){var d=this,a=d.getView(),c=d.lookup('calTitle'),b;if(a&&c){a=a.activeView;b=a.lookupTpl('titleTpl');if(b){c.setHtml(b.apply(a.getDisplayRange()))}}},setViewCfg:function(b,c){if(!this.isConfiguring){var a=this.getView();if(a){a[b](c)}}},weightSorter:function(a,b){return a.weight-b.weight}}});Ext.define('Ext.calendar.theme.Palette',{primary:null,secondary:null,border:null,constructor:function(a){Ext.apply(this,a)}});